[["topic-02.html", "4 Topic 02 4.1 Statistical Model 4.2 Simulation 4.3 Least-Squares Estimator 4.4 Sample Distribution of Least-Squares Estimator", " 4 Topic 02 4.1 Statistical Model Statistical model for each observations \\(i\\) (same \\(k\\) regressors across \\(m\\) equations), \\[\\begin{align*} \\underset{\\left(m \\times 1\\right)}{y_{i}} &amp;= \\underset{\\left(m\\times mk\\right)}{\\overline{X}_{i}} \\underset{\\left(mk \\times 1\\right)}{\\beta} + \\underset{\\left(m \\times 1\\right)}{e_{i}}, \\\\ \\begin{bmatrix} y_{1i} \\\\ y_{2i} \\\\ \\vdots \\\\ y_{mi} \\end{bmatrix} &amp;= \\begin{bmatrix} x_{1i}^{&#39;} &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; x_{2i}^{&#39;} &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; 0 \\\\ 0 &amp; 0&amp; \\cdots &amp; x_{mi}^{&#39;} \\end{bmatrix} + \\begin{bmatrix} \\beta_{1} \\\\ \\beta_{2} \\\\ \\vdots \\\\ \\beta_{m} \\end{bmatrix} + \\begin{bmatrix} u_{1i} \\\\ u_{2i} \\\\ \\vdots \\\\ u_{mi} \\end{bmatrix}, \\end{align*}\\] with, \\(y_{ji}\\) and \\(e_{ji}\\) are scalars for \\(j=1,...,m\\). \\(x_{ji}\\) are \\(\\left(k \\times 1\\right)\\) matrix for \\(j=1,...,m\\). \\(\\beta\\) are \\(\\left(k \\times 1\\right)\\) matrix for \\(j=1,...,m\\). With the same \\(k\\) regressors across \\(m\\) equations this simplifies to, \\[\\begin{align*} \\underset{\\left(m \\times 1\\right)}{y_{i}} &amp;= \\underset{\\left(m\\times mk\\right)}{\\left(\\underset{\\left(m \\times m\\right)}{I_{m}} \\otimes \\underset{\\left(1\\times k\\right)}{x_{i}^{&#39;}}\\right)} \\underset{\\left(mk \\times 1\\right)}{\\beta} + \\underset{\\left(m \\times 1\\right)}{e_{i}}, \\end{align*}\\] thus, \\[\\begin{align*} \\overline{X}_{i} =\\underset{\\left(m \\times mk\\right)}{\\underset{\\left(m \\times m\\right)}{I_{m}} \\otimes \\underset{\\left(1 \\times k\\right)}{x_{i}^{&#39;}}} \\end{align*}\\] Statistical model in matrix notation across observations \\(i\\) (same \\(k\\) regressors across \\(m\\) equations), \\[\\begin{align*} \\underset{\\left(n \\times m\\right)}{Y} &amp;= \\underset{\\left(n\\times k\\right)}{X} \\underset{\\left(k \\times m\\right)}{B} + \\underset{\\left(n \\times k\\right)}{E}. \\end{align*}\\] 4.2 Simulation 4.2.1 Set up # clear workspace rm (list = ls(all=TRUE)) # set seed set.seed(1234567, kind=&quot;Mersenne-Twister&quot;) 4.2.2 Data Generating Process \\[\\begin{align*} y_t B + x_t A &amp;= u_t \\\\ u_t &amp;= u_{t-1} P + v_t \\\\ v_t &amp;= N\\left(0, V_t\\right) \\\\ V_t &amp;= S_t S_t^{&#39;} \\\\ S_t &amp;= C + D w_t \\\\ x_{1t} &amp;\\sim U\\left[x_{1l},x_{1u}\\right] \\\\ x_{1t} &amp;\\sim N \\left(\\mu_{x_{1}},\\sigma_{x_{1}}^2\\right) \\end{align*}\\] 4.2.3 Simulation # number of observations t &lt;- 2000 # parameters b1 &lt;- 0.6 b2 &lt;- 0.2 a1 &lt;- 0.4 a2 &lt;- -0.5 c11 &lt;- 1.0 c21 &lt;- 0.5 c22 &lt;- 2.0 d11 &lt;- 0.5 d21 &lt;- 0.2 d22 &lt;- 0.2 p11 &lt;- 0.8 p12 &lt;- 0.1 p21 &lt;- -0.2 p22 &lt;- 0.6 b &lt;- matrix(c(1, -b2, -b1, 1), nrow=2, byrow=T) a &lt;- matrix(c(-a1, 0, 0, -a2), nrow=2, byrow=T) c &lt;- matrix(c(c11, 0, c21, c22), nrow=2, byrow=T) d &lt;- matrix(c(d11, 0, d21, d22), nrow=2, byrow=T) # exogenous variables x &lt;- cbind(10*runif(t), 3*rnorm(t)) w &lt;- runif(t) # disturbances zeros &lt;- array(0, c(t,2)) u &lt;- zeros v &lt;- zeros for (i in 2:t) { l &lt;- c + d * w[i] v[i,] &lt;- rnorm(2) %*% t(l) u[i,1] &lt;- p11*u[i-1,1] + p12*u[i-1,2] + v[i,1] u[i,2] &lt;- p21*u[i-1,1] + p22*u[i-1,2] + v[i,2] } # simulate the reduced form y &lt;- zeros for (i in seq(t)) { y[i,] &lt;- -x[i,] %*% a %*% solve(b) + u[i,] %*% solve(b) } 4.2.4 Plots par(mfrow=c(1,2)) ts.plot(y[,1]) ts.plot(y[,2]) 4.2.5 Reduced form parameters # parameteres of the reduced form ab &lt;- -a %*% solve(b) ab ## [,1] [,2] ## [1,] 0.4545455 0.09090909 ## [2,] -0.3409091 -0.56818182 4.3 Least-Squares Estimator Use the stacked model in matrix notation across equations \\(j\\) and observations \\(i\\). # dimensions m &lt;- ncol(y);m ## [1] 2 t &lt;- nrow(y);t ## [1] 2000 n &lt;- t k &lt;- ncol(x);k ## [1] 2 # stack regressands and regressors Y &lt;- as.vector(y) # stack y over observations length(Y) ## [1] 4000 X &lt;- diag(m) %x% x # stack x over observations dim(X) ## [1] 4000 4 # estimation lm.res.01 &lt;- lm(Y ~ X - 1) lm.res.01$coefficients ## X1 X2 X3 X4 ## 0.44495050 -0.37735285 0.07649982 -0.60879807 # compare with reduced form parameters for simulation as.vector(ab) ## [1] 0.45454545 -0.34090909 0.09090909 -0.56818182 # expand residuals again e &lt;- matrix(lm.res.01$residuals, ncol = m) dim(e) ## [1] 2000 2 Sig.e &lt;- 1/t * t(e) %*% e Sig.e ## [,1] [,2] ## [1,] 10.861852 7.894577 ## [2,] 7.894577 9.537205 # compare with reduced form parameters for simulation Use the stacked model in matrix notation across observations \\(i\\). # estimation lm.res.02 &lt;- lm(y ~ x - 1) lm.res.02$coefficients ## [,1] [,2] ## x1 0.4449505 0.07649982 ## x2 -0.3773529 -0.60879807 # compare with reduced form parameters for simulation as.vector(ab) ## [1] 0.45454545 -0.34090909 0.09090909 -0.56818182 4.4 Sample Distribution of Least-Squares Estimator General distribution of \\(\\widehat{\\beta}\\): \\[\\begin{align*} \\sqrt{n} \\left(\\widehat{\\beta} - \\beta\\right) &amp;\\underset{d}{\\rightarrow}N\\left(0, V_{\\beta}\\right) \\\\ \\widehat{\\beta} &amp;\\underset{a}{\\sim}N\\left(\\beta, \\frac{V_{\\beta}}{n}\\right) \\end{align*}\\] General form: \\[\\begin{align*} V_{\\beta} = Q^{-1} \\Omega Q^{-1} \\end{align*}\\] 4.4.1 Population Quantities \\(\\Omega\\) in the population (robust w.r.t heteroskedasticity): \\[\\begin{align*} \\underset{\\left(mk\\times m\\right)}{\\overline{X}_{i}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{e_{i}} = \\left(\\begin{array}{c} \\underset{\\left(k\\times 1\\right)}{x_{1i}}\\underset{\\left(k\\times 1\\right)}{e_{1i}} \\\\ \\vdots \\\\ \\underset{\\left(k\\times 1\\right)}{x_{mi}}\\underset{\\left(1\\times 1\\right)}{e_{mi}} \\end{array}\\right) \\end{align*}\\] \\[\\begin{align*} \\frac{1}{\\sqrt{n}}\\sum_{i=1}^{n}\\underset{\\left(mk\\times m\\right)}{\\overline{X}_{i}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{e_{i}} \\underset{d}{\\rightarrow}N\\left(\\underset{\\left(mk\\times 1\\right)}{0}\\underset{\\left(mk\\times mk\\right)}{\\Omega}\\right) \\end{align*}\\] \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{\\Omega} &amp;= \\text{E}\\left[\\underset{\\left(mk\\times m\\right)}{\\overline{X}_{i}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{e_{i}^{\\phantom{&#39;}}}\\underset{\\left(1\\times m\\right)}{e_{i}^{&#39;}}\\underset{\\left(m\\times km\\right)}{\\overline{X}_{i}^{\\phantom{&#39;}}}\\right] \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\Omega}} &amp;= \\text{E} \\left[ \\underset{\\left(mk \\times m\\right)}{\\left( \\underset{\\left(m \\times m\\right)}{I_{m}^{\\phantom{&#39;}}} \\otimes \\underset{\\left(k \\times 1\\right)}{x_{i}^{\\phantom{&#39;}}} \\right)} \\underset{\\left(m \\times 1\\right)}{e_{i}^{\\phantom{&#39;}}} \\underset{\\left(1 \\times m\\right)}{e_{i}^{&#39;}} \\underset{\\left(m \\times mk\\right)}{\\left( \\underset{\\left(m \\times m\\right)}{I_{m}^{\\phantom{&#39;}}} \\otimes \\underset{\\left(1 \\times k\\right)}{x_{i}^{&#39;}} \\right)} \\right] \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\Omega}} &amp;= \\text{E}\\left[\\underset{\\left(m \\times 1\\right)}{e_{i}^{\\phantom{&#39;}}}\\underset{\\left(1 \\times m\\right)}{e_{i}^{&#39;}} \\otimes \\underset{\\left(k \\times 1\\right)}{x_{i}^{\\phantom{&#39;}}}\\underset{\\left(1 \\times k\\right)}{x_{i}^{&#39;}}\\right] \\end{align*}\\] \\(\\Omega\\) in the population (restricted to homoskedasticity): \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{\\Omega} &amp;= \\text{E}\\left[\\underset{\\left(mk\\times m\\right)}{\\overline{X}_{i}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{e_{i}^{\\phantom{&#39;}}}\\underset{\\left(1\\times m\\right)}{e_{i}^{&#39;}}\\underset{\\left(m\\times km\\right)}{\\overline{X}_{i}^{\\phantom{&#39;}}}\\right] \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\Omega}} &amp;= \\text{E} \\left[ \\underset{\\left(mk \\times m\\right)}{\\left( \\underset{\\left(m \\times m\\right)}{I_{m}^{\\phantom{&#39;}}} \\otimes \\underset{\\left(k \\times 1\\right)}{x_{i}^{\\phantom{&#39;}}} \\right)} \\underset{\\left(m \\times m\\right)}{\\Sigma} \\underset{\\left(m \\times mk\\right)}{\\left( \\underset{\\left(m \\times m\\right)}{I_{m}^{\\phantom{&#39;}}} \\otimes \\underset{\\left(1 \\times k\\right)}{x_{i}^{&#39;}} \\right)} \\right] \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\Omega}} &amp;= \\text{E}\\left[\\underset{\\left(m \\times m\\right)}{\\Sigma} \\otimes \\underset{\\left(k \\times 1\\right)}{x_{i}^{\\phantom{&#39;}}}\\underset{\\left(1 \\times k\\right)}{x_{i}^{&#39;}}\\right] \\end{align*}\\] with \\[\\begin{align*} \\underset{\\left(m \\times m\\right)}{\\Sigma} = \\text{E}\\left[\\underset{\\left(m \\times 1\\right)}{e_{i}^{\\phantom{&#39;}}} \\underset{\\left(1 \\times m\\right)}{e_{i}^{&#39;}} \\right] \\end{align*}\\] \\(\\Omega\\) in the population (robust w.r.t heteroskedasticity and serial correlation): \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{\\Omega} &amp;= \\sum_{l=-\\infty}^{\\infty} \\text{E}\\left[\\underset{\\left(mk\\times m\\right)}{\\overline{X}_{t-l}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{e_{t-l}^{\\phantom{&#39;}}}\\underset{\\left(1\\times m\\right)}{e_{t}^{&#39;}}\\underset{\\left(m\\times km\\right)}{\\overline{X}_{t}^{\\phantom{&#39;}}}\\right] \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\Omega}} &amp;= \\sum_{l=-\\infty}^{\\infty} \\text{E} \\left[ \\underset{\\left(mk \\times m\\right)}{\\left( \\underset{\\left(m \\times m\\right)}{I_{m}^{\\phantom{&#39;}}} \\otimes \\underset{\\left(k \\times 1\\right)}{x_{t-l}^{\\phantom{&#39;}}} \\right)} \\underset{\\left(m \\times 1\\right)}{e_{t-l}^{\\phantom{&#39;}}} \\underset{\\left(1 \\times m\\right)}{e_{t}^{&#39;}} \\underset{\\left(m \\times mk\\right)}{\\left( \\underset{\\left(m \\times m\\right)}{I_{m}^{\\phantom{&#39;}}} \\otimes \\underset{\\left(1 \\times k\\right)}{x_{t}^{&#39;}} \\right)} \\right] \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\Omega}} &amp;= \\sum_{l=-\\infty}^{\\infty} \\text{E}\\left[\\underset{\\left(m \\times 1\\right)}{e_{t-l}^{\\phantom{&#39;}}}\\underset{\\left(1 \\times m\\right)}{e_{t}^{&#39;}} \\otimes \\underset{\\left(k \\times 1\\right)}{x_{t-l}^{\\phantom{&#39;}}}\\underset{\\left(1 \\times k\\right)}{x_{t}^{&#39;}}\\right] \\end{align*}\\] \\(Q\\) in the population: \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{Q} &amp;= \\text{E} \\left[ \\overline{X}_{i}^{&#39;} \\overline{X}_{i} \\right] \\\\ \\phantom{Q} &amp;= \\text{E} \\left[ \\left( I_{m} \\otimes x_{i} \\right) \\left( I_{m} \\otimes x_{i}^{&#39;} \\right) \\right] \\\\ \\phantom{Q} &amp;= I_{m} \\otimes \\text{E} \\left[ x_{i}^{&#39;} x_{i} \\right] \\end{align*}\\] 4.4.2 Sample Quantities Sample counterpart of \\(\\Omega\\) (robust w.r.t heteroskedasticity): \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\underset{\\left(mk\\times m\\right)}{\\overline{X}_{i}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{\\widehat{e}_{i}}\\underset{\\left(1\\times m\\right)}{\\widehat{e}_{i}^{&#39;}}\\underset{\\left(m\\times km\\right)}{\\overline{X}_{i}} \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}}} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\left( I_{m} \\otimes x_{i} \\right) \\widehat{e}_{i} \\widehat{e}_{i}^{&#39;} \\left( I_{m} \\otimes x_{i}^{&#39;} \\right) \\right) \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}}} &amp;= \\frac{1}{n} \\sum_{i=1}^{n}\\left(\\widehat{e}_{i}\\widehat{e}_{i}^{&#39;} \\otimes x_{i}x_{i}^{&#39;}\\right) \\end{align*}\\] Omega.02 &lt;- matrix(0, nrow = m*k, ncol = m*k) for (i in 1:t) { Omega.02 &lt;- Omega.02 + ((t(e[i,,drop=F]) %*% e[i,,drop=F]) %x% (t(x[i,,drop=F]) %*% x[i,,drop=F])) } Omega.02 ## [,1] [,2] [,3] [,4] ## [1,] 763978.840 -6110.841 544830.0537 -2644.1640 ## [2,] -6110.841 221020.120 -2644.1640 160775.7440 ## [3,] 544830.054 -2644.164 644883.9511 682.2508 ## [4,] -2644.164 160775.744 682.2508 183696.0895 Omega.02.hat &lt;- 1/n * Omega.02 Omega.02.hat ## [,1] [,2] [,3] [,4] ## [1,] 381.989420 -3.055420 272.4150269 -1.3220820 ## [2,] -3.055420 110.510060 -1.3220820 80.3878720 ## [3,] 272.415027 -1.322082 322.4419756 0.3411254 ## [4,] -1.322082 80.387872 0.3411254 91.8480448 # or, xe.01 &lt;- matrix(seq(1,t*m*k), nrow = t, ncol = m*k) for (i in 1:t) { for (j in 1:m) { xe.01[i,(k*(j-1)+1):(k*j)] &lt;- x[i,,drop=F] * e[i,j,drop=T] } } 1/n * (t(xe.01) %*% xe.01) ## [,1] [,2] [,3] [,4] ## [1,] 381.989420 -3.055420 272.4150269 -1.3220820 ## [2,] -3.055420 110.510060 -1.3220820 80.3878720 ## [3,] 272.415027 -1.322082 322.4419756 0.3411254 ## [4,] -1.322082 80.387872 0.3411254 91.8480448 Sample counterpart of \\(\\Omega\\) (restricted to homoskedasticity): \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\underset{\\left(mk\\times m\\right)}{\\overline{X}_{i}^{&#39;}}\\underset{\\left(m\\times 1\\right)}{\\widehat{e}_{i}}\\underset{\\left(1\\times m\\right)}{\\widehat{e}_{i}^{&#39;}}\\underset{\\left(m\\times km\\right)}{\\overline{X}_{i}} \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}}} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\left( I_{m} \\otimes x_{i} \\right) \\widehat{\\Sigma} \\left( I_{m} \\otimes x_{i}^{&#39;} \\right) \\right) \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}}} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\widehat{\\Sigma} \\otimes x_{i}^{\\phantom{&#39;}}x_{i}^{&#39;} \\right) \\\\ \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}}} &amp;= \\widehat{\\Sigma} \\otimes \\frac{1}{n} \\sum_{i=1}^{n} x_{i}^{\\phantom{&#39;}}x_{i}^{&#39;} \\end{align*}\\] with \\[\\begin{align*} \\widehat{\\Sigma} = \\frac{1}{n} \\sum_{i=1}^{n} \\left( {e_{i} e_{i}^{&#39;}} \\right) \\end{align*}\\] Omega.01 &lt;- ((t(e) %*% e) / n) %x% (t(x) %*% x) Omega.01 ## [,1] [,2] [,3] [,4] ## [1,] 736698.769 -2735.127 535445.089 -1987.936 ## [2,] -2735.127 196232.256 -1987.936 142624.913 ## [3,] 535445.089 -1987.936 646855.337 -2401.567 ## [4,] -1987.936 142624.913 -2401.567 172300.929 Omega.01.hat &lt;- 1/n * Omega.01 Omega.01.hat ## [,1] [,2] [,3] [,4] ## [1,] 368.349384 -1.367563 267.722544 -0.993968 ## [2,] -1.367563 98.116128 -0.993968 71.312457 ## [3,] 267.722544 -0.993968 323.427669 -1.200783 ## [4,] -0.993968 71.312457 -1.200783 86.150465 # check (t(e) %*% e / n) %x% (t(x) %*% x) ## [,1] [,2] [,3] [,4] ## [1,] 736698.769 -2735.127 535445.089 -1987.936 ## [2,] -2735.127 196232.256 -1987.936 142624.913 ## [3,] 535445.089 -1987.936 646855.337 -2401.567 ## [4,] -1987.936 142624.913 -2401.567 172300.929 Sample counterpart of \\(\\Omega\\) (robust w.r.t heteroskedasticity and serial correlation):  Sample counterpart of \\(Q\\): \\[\\begin{align*} \\underset{\\left(mk\\times mk\\right)}{Q} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\overline{X}_{i}^{&#39;} \\overline{X}_{i} \\right) \\\\ \\phantom{Q} &amp;= \\frac{1}{n} \\sum_{i=1}^{n} \\left( \\left( I_{m} \\otimes x_{i} \\right) \\left( I_{m} \\otimes x_{i}^{&#39;} \\right) \\right) \\\\ \\phantom{Q} &amp;= I_{m} \\otimes \\frac{1}{n} \\sum_{i=1}^{n} \\left( x_{i}^{&#39;} x_{i} \\right) \\end{align*}\\] Q &lt;- diag(m) %x% (t(x) %*% x) Q ## [,1] [,2] [,3] [,4] ## [1,] 67824.4170 -251.8103 0.0000 0.0000 ## [2,] -251.8103 18066.1879 0.0000 0.0000 ## [3,] 0.0000 0.0000 67824.4170 -251.8103 ## [4,] 0.0000 0.0000 -251.8103 18066.1879 Q.hat &lt;- 1/n * Q Q.hat ## [,1] [,2] [,3] [,4] ## [1,] 33.9122085 -0.1259052 0.0000000 0.0000000 ## [2,] -0.1259052 9.0330940 0.0000000 0.0000000 ## [3,] 0.0000000 0.0000000 33.9122085 -0.1259052 ## [4,] 0.0000000 0.0000000 -0.1259052 9.0330940 Sample counterpart of \\(V_{\\beta}\\) (robust w.r.t heteroskedasticity): \\[\\begin{align*} \\widehat{V}_{\\widehat{\\beta}} &amp;= \\widehat{Q}^{-1} \\widehat{\\Omega} \\widehat{Q}^{-1} \\\\ \\phantom{\\widehat{V}_{\\widehat{\\beta}}} &amp;= \\left(I_{m} \\otimes \\frac{1}{n} \\sum_{i=1}^{n} \\left( x_{i}^{&#39;} x_{i} \\right)\\right)^{-1} \\frac{1}{n} \\sum_{i=1}^{n}\\left(\\widehat{e}_{i}\\widehat{e}_{i}^{&#39;} \\otimes x_{i}x_{i}^{&#39;}\\right) \\left(I_{m} \\otimes \\frac{1}{n} \\sum_{i=1}^{n} \\left( x_{i}^{&#39;} x_{i} \\right)\\right)^{-1} \\\\ \\phantom{\\widehat{V}_{\\widehat{\\beta}}} &amp;= \\left(I_{m} \\otimes \\left( \\frac{1}{n} X^{&#39;} X \\right)^{-1}\\right) \\sum_{i=1}^{n}\\left(\\widehat{e}_{i}\\widehat{e}_{i}^{&#39;} \\otimes x_{i}x_{i}^{&#39;}\\right) \\left(I_{m} \\otimes \\left( \\frac{1}{n} X^{&#39;} X \\right)^{-1}\\right) \\end{align*}\\] V.b.02 &lt;- solve(Q) %*% Omega.02 %*% solve(Q) V.b.02 ## [,1] [,2] [,3] [,4] ## [1,] 1.660664e-04 -1.584418e-07 1.184404e-04 1.321745e-06 ## [2,] -1.584418e-07 6.771350e-04 1.321745e-06 4.926060e-04 ## [3,] 1.184404e-04 1.321745e-06 1.402139e-04 4.600816e-06 ## [4,] 1.321745e-06 4.926060e-04 4.600816e-06 5.629176e-04 V.b.hat.02 &lt;- solve(Q.hat) %*% Omega.02.hat %*% solve(Q.hat) V.b.hat.02 ## [,1] [,2] [,3] [,4] ## [1,] 0.3321327507 -0.0003168837 0.236880877 0.002643491 ## [2,] -0.0003168837 1.3542699333 0.002643491 0.985211961 ## [3,] 0.2368808775 0.0026434906 0.280427897 0.009201632 ## [4,] 0.0026434906 0.9852119614 0.009201632 1.125835144 Sample counterpart of \\(V_{\\beta}\\) (restricted to homoskedasticity): \\[\\begin{align*} \\widehat{V}_{\\widehat{\\beta}} &amp;= \\widehat{Q}^{-1} \\widehat{\\Omega} \\widehat{Q}^{-1} \\\\ \\phantom{\\widehat{V}_{\\widehat{\\beta}}} &amp;= \\left(I_{m} \\otimes \\sum_{i=1}^{n} \\left( x_{i}^{&#39;} x_{i} \\right)\\right)^{-1} \\sum_{i=1}^{n} \\left( \\left( I_{m} \\otimes x_{i} \\right) \\widehat{\\Sigma} \\left( I_{m} \\otimes x_{i}^{&#39;} \\right) \\right) \\left(I_{m} \\otimes \\sum_{i=1}^{n} \\left( x_{i}^{&#39;} x_{i} \\right)\\right)^{-1} \\\\ \\phantom{\\widehat{V}_{\\widehat{\\beta}}} \\phantom{\\underset{\\left(mk\\times mk\\right)}{\\widehat{\\Omega}}} &amp;= \\widehat{\\Sigma} \\otimes \\sum_{i=1}^{n} x_{i}^{\\phantom{&#39;}}x_{i}^{&#39;} \\end{align*}\\] V.b.01 &lt;- solve(Q) %*% Omega.01 %*% solve(Q) V.b.01 ## [,1] [,2] [,3] [,4] ## [1,] 1.601549e-04 2.232273e-06 1.164033e-04 1.622454e-06 ## [2,] 2.232273e-06 6.012566e-04 1.622454e-06 4.370034e-04 ## [3,] 1.164033e-04 1.622454e-06 1.406234e-04 1.960038e-06 ## [4,] 1.622454e-06 4.370034e-04 1.960038e-06 5.279309e-04 # or, (t(e) %*% e) %x% solve(t(x) %*% x) ## [,1] [,2] [,3] [,4] ## [1,] 0.320309837 0.004464546 0.232806591 0.003244907 ## [2,] 0.004464546 1.202513116 0.003244907 0.874006812 ## [3,] 0.232806591 0.003244907 0.281246740 0.003920076 ## [4,] 0.003244907 0.874006812 0.003920076 1.055861717 V.b.hat.01 &lt;- solve(Q.hat) %*% Omega.01.hat %*% solve(Q.hat) V.b.hat.01 ## [,1] [,2] [,3] [,4] ## [1,] 0.320309837 0.004464546 0.232806591 0.003244907 ## [2,] 0.004464546 1.202513116 0.003244907 0.874006812 ## [3,] 0.232806591 0.003244907 0.281246740 0.003920076 ## [4,] 0.003244907 0.874006812 0.003920076 1.055861717 Sample counterpart of \\(V_{\\beta}\\) (robust w.r.t heteroskedasticity and serial correlation):  "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
