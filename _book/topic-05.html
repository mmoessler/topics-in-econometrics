<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Topic 05 | Topics in Statistics and Econometrics</title>
  <meta name="description" content="This book contains some thoughts on selected topics in statistics and econometrics" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Topic 05 | Topics in Statistics and Econometrics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book contains some thoughts on selected topics in statistics and econometrics" />
  <meta name="github-repo" content="mmoessler/topics-in-statistics-and-econometrics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Topic 05 | Topics in Statistics and Econometrics" />
  
  <meta name="twitter:description" content="This book contains some thoughts on selected topics in statistics and econometrics" />
  

<meta name="author" content="Markus Mößler" />


<meta name="date" content="2023-06-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="topic-04.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script src="script.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Topics in Statistics and Econometrics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Motivation</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="topic-01.html"><a href="topic-01.html"><i class="fa fa-check"></i><b>3</b> Topic 01</a>
<ul>
<li class="chapter" data-level="3.1" data-path="topic-01.html"><a href="topic-01.html#motivation-1"><i class="fa fa-check"></i><b>3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2" data-path="topic-01.html"><a href="topic-01.html#probelm"><i class="fa fa-check"></i><b>3.2</b> Probelm</a></li>
<li class="chapter" data-level="3.3" data-path="topic-01.html"><a href="topic-01.html#analysis"><i class="fa fa-check"></i><b>3.3</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="topic-02.html"><a href="topic-02.html"><i class="fa fa-check"></i><b>4</b> Topic 02</a>
<ul>
<li class="chapter" data-level="4.1" data-path="topic-02.html"><a href="topic-02.html#statistical-model"><i class="fa fa-check"></i><b>4.1</b> Statistical Model</a></li>
<li class="chapter" data-level="4.2" data-path="topic-02.html"><a href="topic-02.html#simulation"><i class="fa fa-check"></i><b>4.2</b> Simulation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="topic-02.html"><a href="topic-02.html#set-up"><i class="fa fa-check"></i><b>4.2.1</b> Set up</a></li>
<li class="chapter" data-level="4.2.2" data-path="topic-02.html"><a href="topic-02.html#data-generating-process"><i class="fa fa-check"></i><b>4.2.2</b> Data Generating Process</a></li>
<li class="chapter" data-level="4.2.3" data-path="topic-02.html"><a href="topic-02.html#simulation-1"><i class="fa fa-check"></i><b>4.2.3</b> Simulation</a></li>
<li class="chapter" data-level="4.2.4" data-path="topic-02.html"><a href="topic-02.html#plots"><i class="fa fa-check"></i><b>4.2.4</b> Plots</a></li>
<li class="chapter" data-level="4.2.5" data-path="topic-02.html"><a href="topic-02.html#reduced-form-parameters"><i class="fa fa-check"></i><b>4.2.5</b> Reduced form parameters</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="topic-02.html"><a href="topic-02.html#least-squares-estimator"><i class="fa fa-check"></i><b>4.3</b> Least-Squares Estimator</a></li>
<li class="chapter" data-level="4.4" data-path="topic-02.html"><a href="topic-02.html#sample-distribution-of-least-squares-estimator"><i class="fa fa-check"></i><b>4.4</b> Sample Distribution of Least-Squares Estimator</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="topic-02.html"><a href="topic-02.html#population-quantities"><i class="fa fa-check"></i><b>4.4.1</b> Population Quantities</a></li>
<li class="chapter" data-level="4.4.2" data-path="topic-02.html"><a href="topic-02.html#sample-quantities"><i class="fa fa-check"></i><b>4.4.2</b> Sample Quantities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="topic-03.html"><a href="topic-03.html"><i class="fa fa-check"></i><b>5</b> Topic 03</a>
<ul>
<li class="chapter" data-level="5.1" data-path="topic-03.html"><a href="topic-03.html#statistical-model-1"><i class="fa fa-check"></i><b>5.1</b> Statistical Model</a></li>
<li class="chapter" data-level="5.2" data-path="topic-03.html"><a href="topic-03.html#estimation"><i class="fa fa-check"></i><b>5.2</b> Estimation</a></li>
<li class="chapter" data-level="5.3" data-path="topic-03.html"><a href="topic-03.html#sample-distribution"><i class="fa fa-check"></i><b>5.3</b> Sample Distribution</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="topic-03.html"><a href="topic-03.html#case-1"><i class="fa fa-check"></i><b>5.3.1</b> Case 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topic-04.html"><a href="topic-04.html"><i class="fa fa-check"></i><b>6</b> Topic 04</a></li>
<li class="chapter" data-level="7" data-path="topic-05.html"><a href="topic-05.html"><i class="fa fa-check"></i><b>7</b> Topic 05</a>
<ul>
<li class="chapter" data-level="7.1" data-path="topic-05.html"><a href="topic-05.html#motivation-2"><i class="fa fa-check"></i><b>7.1</b> Motivation</a></li>
<li class="chapter" data-level="7.2" data-path="topic-05.html"><a href="topic-05.html#linear-vecm-model-estimation"><i class="fa fa-check"></i><b>7.2</b> Linear VECM model estimation</a></li>
<li class="chapter" data-level="7.3" data-path="topic-05.html"><a href="topic-05.html#linear-vecm-model-orthogonalized-irf-analysis"><i class="fa fa-check"></i><b>7.3</b> Linear VECM model orthogonalized IRF analysis</a></li>
<li class="chapter" data-level="7.4" data-path="topic-05.html"><a href="topic-05.html#linear-vecm-model-generalized-irf-analysis"><i class="fa fa-check"></i><b>7.4</b> Linear VECM model generalized IRF analysis</a></li>
<li class="chapter" data-level="7.5" data-path="topic-05.html"><a href="topic-05.html#tvecm-model-estimation"><i class="fa fa-check"></i><b>7.5</b> TVECM model estimation</a></li>
<li class="chapter" data-level="7.6" data-path="topic-05.html"><a href="topic-05.html#tvecm-model-orthngalized-irf-analysis"><i class="fa fa-check"></i><b>7.6</b> TVECM model orthngalized IRF analysis</a></li>
<li class="chapter" data-level="7.7" data-path="topic-05.html"><a href="topic-05.html#tvecm-model-generalized-irf-analysis"><i class="fa fa-check"></i><b>7.7</b> TVECM model generalized IRF analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Topics in Statistics and Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="topic-05" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Topic 05<a href="topic-05.html#topic-05" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- <link rel="stylesheet" type="text/css" href="style.css"> -->
<div id="motivation-2" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Motivation<a href="topic-05.html#motivation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comparison of the analysis of multivariate time series using the <code>urca</code> in combination with the <code>vars</code> package and the <code>tsDyn</code> package</p>
</div>
<div id="linear-vecm-model-estimation" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Linear VECM model estimation<a href="topic-05.html#linear-vecm-model-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="topic-05.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tsDyn<span class="sc">::</span>zeroyldMeta<span class="sc">$</span>Date, tsDyn<span class="sc">::</span>zeroyldMeta<span class="sc">$</span>short.run, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb1-2"><a href="topic-05.html#cb1-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Date&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Rate&quot;</span>)</span>
<span id="cb1-3"><a href="topic-05.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tsDyn<span class="sc">::</span>zeroyldMeta<span class="sc">$</span>Date, tsDyn<span class="sc">::</span>zeroyldMeta<span class="sc">$</span>long.run, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb1-4"><a href="topic-05.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb1-5"><a href="topic-05.html#cb1-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Short rate: 12 months&quot;</span>, <span class="st">&quot;Long rate: 120 months&quot;</span>))</span></code></pre></div>
<p><img src="topics-in-statistics-and-econometrics_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="topic-05.html#cb2-1" aria-hidden="true" tabindex="-1"></a>vecm.tsdyn <span class="ot">&lt;-</span> tsDyn<span class="sc">::</span><span class="fu">VECM</span>(tsDyn<span class="sc">::</span>zeroyldMeta[, <span class="fu">c</span>(<span class="st">&quot;long.run&quot;</span>, <span class="st">&quot;short.run&quot;</span>)], <span class="at">r =</span> <span class="dv">1</span>, <span class="at">lag =</span> <span class="dv">1</span>, <span class="at">estim =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb2-2"><a href="topic-05.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vecm.tsdyn)</span></code></pre></div>
<pre><code>## #############
## ###Model VECM 
## #############
## Full sample size: 482    End sample size: 480
## Number of variables: 2   Number of estimated slope parameters 8
## AIC -2155.763    BIC -2118.199   SSR 176.3897
## Cointegrating vector (estimated by ML):
##    long.run short.run
## r1        1 -1.022065
## 
## 
##                    ECT                 Intercept           long.run -1       
## Equation long.run  -0.0116(0.0153)     0.0169(0.0158)      0.0480(0.0682)    
## Equation short.run 0.0888(0.0262)***   -0.0362(0.0271)     0.3254(0.1171)**  
##                    short.run -1      
## Equation long.run  0.0116(0.0392)    
## Equation short.run 0.0506(0.0673)</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="topic-05.html#cb4-1" aria-hidden="true" tabindex="-1"></a>vecm.urca <span class="ot">&lt;-</span> urca<span class="sc">::</span><span class="fu">ca.jo</span>(<span class="at">x =</span> tsDyn<span class="sc">::</span>zeroyldMeta[, <span class="fu">c</span>(<span class="st">&quot;long.run&quot;</span>, <span class="st">&quot;short.run&quot;</span>)], <span class="at">ecdet =</span> <span class="st">&quot;none&quot;</span>, <span class="at">K =</span> <span class="dv">2</span>)</span>
<span id="cb4-2"><a href="topic-05.html#cb4-2" aria-hidden="true" tabindex="-1"></a>vecm.urca<span class="sc">@</span>V</span></code></pre></div>
<pre><code>##              long.run.l2 short.run.l2
## long.run.l2     1.000000    1.0000000
## short.run.l2   -1.022065   -0.2409262</code></pre>
</div>
<div id="linear-vecm-model-orthogonalized-irf-analysis" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Linear VECM model orthogonalized IRF analysis<a href="topic-05.html#linear-vecm-model-orthogonalized-irf-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Compare non-orthogonalized IRFs first</p>
<!-- .................................................. -->
<button type="button" class="collButtonCl">
<span style="font-size: 14pt;"><code>tsdyn</code></span>
</button>
<div class="collContentCl">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="topic-05.html#cb6-1" aria-hidden="true" tabindex="-1"></a>irf.tsdyn <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">irf.VECM</span>(vecm.tsdyn, <span class="at">ortho =</span> <span class="cn">FALSE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="topic-05.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="topic-05.html#cb6-3" aria-hidden="true" tabindex="-1"></a>irf.tsdyn<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##         long.run short.run
##  [1,] 0.00000000 1.0000000
##  [2,] 0.02349183 0.9598307
##  [3,] 0.03527669 0.8804053
##  [4,] 0.04496349 0.8034402
##  [5,] 0.05355177 0.7337633
##  [6,] 0.06124490 0.6711849
##  [7,] 0.06814511 0.6150379
##  [8,] 0.07433515 0.5646676
##  [9,] 0.07988821 0.5194802
## [10,] 0.08486985 0.4789427
## [11,] 0.08933889 0.4425764</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="topic-05.html#cb8-1" aria-hidden="true" tabindex="-1"></a>irf.tsdyn<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##       long.run short.run
##  [1,] 1.000000 0.0000000
##  [2,] 1.036387 0.4141980
##  [3,] 1.035824 0.5014409
##  [4,] 1.030731 0.5521480
##  [5,] 1.025657 0.5944773
##  [6,] 1.021048 0.6320963
##  [7,] 1.016908 0.6658043
##  [8,] 1.013192 0.6960393
##  [9,] 1.009859 0.7231626
## [10,] 1.006869 0.7474948
## [11,] 1.004186 0.7693232</code></pre>
</div>
<!-- .................................................. -->
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="topic-05.html#cb10-1" aria-hidden="true" tabindex="-1"></a>v2v.vars <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">vec2var</span>(vecm.urca, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="topic-05.html#cb10-2" aria-hidden="true" tabindex="-1"></a>v2v.vars <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(v2v.vars, <span class="at">ortho =</span> <span class="cn">FALSE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-3"><a href="topic-05.html#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="topic-05.html#cb10-4" aria-hidden="true" tabindex="-1"></a>v2v.vars<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##         long.run short.run
##  [1,] 0.00000000 1.0000000
##  [2,] 0.02349183 0.9598307
##  [3,] 0.03527669 0.8804053
##  [4,] 0.04496349 0.8034402
##  [5,] 0.05355177 0.7337633
##  [6,] 0.06124490 0.6711849
##  [7,] 0.06814511 0.6150379
##  [8,] 0.07433515 0.5646676
##  [9,] 0.07988821 0.5194802
## [10,] 0.08486985 0.4789427
## [11,] 0.08933889 0.4425764</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="topic-05.html#cb12-1" aria-hidden="true" tabindex="-1"></a>v2v.vars<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##       long.run short.run
##  [1,] 1.000000 0.0000000
##  [2,] 1.036387 0.4141980
##  [3,] 1.035824 0.5014409
##  [4,] 1.030731 0.5521480
##  [5,] 1.025657 0.5944773
##  [6,] 1.021048 0.6320963
##  [7,] 1.016908 0.6658043
##  [8,] 1.013192 0.6960393
##  [9,] 1.009859 0.7231626
## [10,] 1.006869 0.7474948
## [11,] 1.004186 0.7693232</code></pre>
<p>Compare orthongonalized IRFs afterwards</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="topic-05.html#cb14-1" aria-hidden="true" tabindex="-1"></a>irf.tsdyn <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">irf.VECM</span>(vecm.tsdyn, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-2"><a href="topic-05.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="topic-05.html#cb14-3" aria-hidden="true" tabindex="-1"></a>irf.tsdyn<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##          long.run short.run
##  [1,] 0.000000000 0.3419007
##  [2,] 0.008031872 0.3281667
##  [3,] 0.012061122 0.3010111
##  [4,] 0.015373048 0.2746967
##  [5,] 0.018309387 0.2508741
##  [6,] 0.020939671 0.2294786
##  [7,] 0.023298858 0.2102819
##  [8,] 0.025415235 0.1930602
##  [9,] 0.027313830 0.1776106
## [10,] 0.029017058 0.1637508
## [11,] 0.030545024 0.1513172</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="topic-05.html#cb16-1" aria-hidden="true" tabindex="-1"></a>irf.tsdyn<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##        long.run short.run
##  [1,] 0.3064400 0.3997063
##  [2,] 0.3269802 0.5105772
##  [3,] 0.3315181 0.5055651
##  [4,] 0.3338293 0.4903403
##  [5,] 0.3357073 0.4754615
##  [6,] 0.3373701 0.4619765
##  [7,] 0.3388592 0.4498636
##  [8,] 0.3401949 0.4389955
##  [9,] 0.3413931 0.4292455
## [10,] 0.3424679 0.4204987
## [11,] 0.3434322 0.4126520</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="topic-05.html#cb18-1" aria-hidden="true" tabindex="-1"></a>v2v.vars <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">vec2var</span>(vecm.urca, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb18-2"><a href="topic-05.html#cb18-2" aria-hidden="true" tabindex="-1"></a>v2v.vars <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">irf</span>(v2v.vars, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-3"><a href="topic-05.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="topic-05.html#cb18-4" aria-hidden="true" tabindex="-1"></a>v2v.vars<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##          long.run short.run
##  [1,] 0.000000000 0.3404731
##  [2,] 0.007998335 0.3267965
##  [3,] 0.012010762 0.2997543
##  [4,] 0.015308860 0.2735498
##  [5,] 0.018232938 0.2498267
##  [6,] 0.020852240 0.2285204
##  [7,] 0.023201576 0.2094039
##  [8,] 0.025309116 0.1922541
##  [9,] 0.027199784 0.1768690
## [10,] 0.028895901 0.1630671
## [11,] 0.030417486 0.1506854</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="topic-05.html#cb20-1" aria-hidden="true" tabindex="-1"></a>v2v.vars<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##        long.run short.run
##  [1,] 0.3051605 0.3980374
##  [2,] 0.3256150 0.5084453
##  [3,] 0.3301339 0.5034542
##  [4,] 0.3324355 0.4882930
##  [5,] 0.3343056 0.4734762
##  [6,] 0.3359614 0.4600475
##  [7,] 0.3374444 0.4479853
##  [8,] 0.3387744 0.4371625
##  [9,] 0.3399676 0.4274532
## [10,] 0.3410380 0.4187430
## [11,] 0.3419983 0.4109290</code></pre>
</div>
<div id="linear-vecm-model-generalized-irf-analysis" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Linear VECM model generalized IRF analysis<a href="topic-05.html#linear-vecm-model-generalized-irf-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Step x: Check class and <code>GIRF</code> method of linear object</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="topic-05.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(vecm.tsdyn)</span></code></pre></div>
<pre><code>## [1] &quot;VECM&quot;  &quot;VAR&quot;   &quot;nlVar&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="topic-05.html#cb24-1" aria-hidden="true" tabindex="-1"></a>tsDyn<span class="sc">:::</span>GIRF.nlVar</span></code></pre></div>
<pre><code>## function (object, n.ahead = 10, seed = NULL, n.hist = 20, n.shock = 20, 
##     R = 10, hist_li = NULL, shock_li = NULL, ...) 
## {
##     GIRF.setar(object, n.ahead = n.ahead, seed = seed, n.hist = n.hist, 
##         n.shock = n.shock, R = R, hist_li = hist_li, shock_li = shock_li, 
##         ...)
## }
## &lt;bytecode: 0x0000020e3a3f4538&gt;
## &lt;environment: namespace:tsDyn&gt;</code></pre>
<p>Step x: Call function <code>tsDyn:::GIRF.setar()</code></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="topic-05.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tsDyn_GIRF_setar_fun no 01 ----</span></span>
<span id="cb26-2"><a href="topic-05.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="topic-05.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tsDyn_GIRF_setar_fun - function (object, n.ahead = 10, seed = NULL, n.hist = 20, n.shock = 20, </span></span>
<span id="cb26-4"><a href="topic-05.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  R = 10, hist_li = NULL, shock_li = NULL, ...) {</span></span>
<span id="cb26-5"><a href="topic-05.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-6"><a href="topic-05.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb26-7"><a href="topic-05.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  object <span class="ot">&lt;-</span> vecm.tsdyn</span>
<span id="cb26-8"><a href="topic-05.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  n.ahead <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb26-9"><a href="topic-05.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  seed <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-10"><a href="topic-05.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  n.hist <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb26-11"><a href="topic-05.html#cb26-11" aria-hidden="true" tabindex="-1"></a>  n.shock <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb26-12"><a href="topic-05.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb26-13"><a href="topic-05.html#cb26-13" aria-hidden="true" tabindex="-1"></a>  hist_li <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-14"><a href="topic-05.html#cb26-14" aria-hidden="true" tabindex="-1"></a>  shock_li <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-15"><a href="topic-05.html#cb26-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-16"><a href="topic-05.html#cb26-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-17"><a href="topic-05.html#cb26-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-18"><a href="topic-05.html#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lag &lt;- tsDyn:::get_lag(object)</span></span>
<span id="cb26-19"><a href="topic-05.html#cb26-19" aria-hidden="true" tabindex="-1"></a>  lag <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_lag.nlVar</span>(object)</span>
<span id="cb26-20"><a href="topic-05.html#cb26-20" aria-hidden="true" tabindex="-1"></a>  n_start <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">inherits</span>(object, <span class="fu">c</span>(<span class="st">&quot;VECM&quot;</span>, <span class="st">&quot;TVECM&quot;</span>)), lag <span class="sc">+</span> <span class="dv">1</span>, lag)</span>
<span id="cb26-21"><a href="topic-05.html#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x_orig &lt;- get_data_orig(object, as.df = TRUE)</span></span>
<span id="cb26-22"><a href="topic-05.html#cb26-22" aria-hidden="true" tabindex="-1"></a>  x_orig <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_data_orig.nlVar</span>(object, <span class="at">as.df =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-23"><a href="topic-05.html#cb26-23" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x_orig)</span>
<span id="cb26-24"><a href="topic-05.html#cb26-24" aria-hidden="true" tabindex="-1"></a>  resids <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">residuals</span>(object, <span class="at">initVal =</span> <span class="cn">FALSE</span>))</span>
<span id="cb26-25"><a href="topic-05.html#cb26-25" aria-hidden="true" tabindex="-1"></a>  n_used <span class="ot">&lt;-</span> <span class="fu">nrow</span>(resids)</span>
<span id="cb26-26"><a href="topic-05.html#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nVar &lt;- get_nVar(object)</span></span>
<span id="cb26-27"><a href="topic-05.html#cb26-27" aria-hidden="true" tabindex="-1"></a>  nVar <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_nVar.nlVar</span>(object)</span>
<span id="cb26-28"><a href="topic-05.html#cb26-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-29"><a href="topic-05.html#cb26-29" aria-hidden="true" tabindex="-1"></a>  sample_hist <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb26-30"><a href="topic-05.html#cb26-30" aria-hidden="true" tabindex="-1"></a>    hist_M <span class="ot">&lt;-</span> <span class="fu">sample</span>(n_start<span class="sc">:</span>N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-31"><a href="topic-05.html#cb26-31" aria-hidden="true" tabindex="-1"></a>    (hist_M <span class="sc">-</span> n_start <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>hist_M</span>
<span id="cb26-32"><a href="topic-05.html#cb26-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-33"><a href="topic-05.html#cb26-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-34"><a href="topic-05.html#cb26-34" aria-hidden="true" tabindex="-1"></a>  nrow_length <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb26-35"><a href="topic-05.html#cb26-35" aria-hidden="true" tabindex="-1"></a>    nr <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb26-36"><a href="topic-05.html#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(nr)) {</span>
<span id="cb26-37"><a href="topic-05.html#cb26-37" aria-hidden="true" tabindex="-1"></a>      nr <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb26-38"><a href="topic-05.html#cb26-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-39"><a href="topic-05.html#cb26-39" aria-hidden="true" tabindex="-1"></a>    nr</span>
<span id="cb26-40"><a href="topic-05.html#cb26-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-41"><a href="topic-05.html#cb26-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-42"><a href="topic-05.html#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(hist_li)) {</span>
<span id="cb26-43"><a href="topic-05.html#cb26-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) {</span>
<span id="cb26-44"><a href="topic-05.html#cb26-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(seed)</span>
<span id="cb26-45"><a href="topic-05.html#cb26-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-46"><a href="topic-05.html#cb26-46" aria-hidden="true" tabindex="-1"></a>    samples_hist <span class="ot">&lt;-</span> <span class="fu">sample</span>(n_start<span class="sc">:</span>N, <span class="at">size =</span> n.hist, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-47"><a href="topic-05.html#cb26-47" aria-hidden="true" tabindex="-1"></a>    hist_li <span class="ot">&lt;-</span> <span class="fu">lapply</span>(samples_hist, <span class="cf">function</span>(i) x_orig[(i <span class="sc">-</span> n_start <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>i, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb26-48"><a href="topic-05.html#cb26-48" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb26-49"><a href="topic-05.html#cb26-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.list</span>(hist_li)) {</span>
<span id="cb26-50"><a href="topic-05.html#cb26-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;hist_li should be a list of vectors/matrices&quot;</span>)</span>
<span id="cb26-51"><a href="topic-05.html#cb26-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-52"><a href="topic-05.html#cb26-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">unique</span>(<span class="fu">sapply</span>(hist_li, nrow_length)) <span class="sc">!=</span> n_start) {</span>
<span id="cb26-53"><a href="topic-05.html#cb26-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;each element of hist_li should have length lags (+1 if VECM)&quot;</span>)</span>
<span id="cb26-54"><a href="topic-05.html#cb26-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-55"><a href="topic-05.html#cb26-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-56"><a href="topic-05.html#cb26-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-57"><a href="topic-05.html#cb26-57" aria-hidden="true" tabindex="-1"></a>  samples_hist <span class="co"># index for history</span></span></code></pre></div>
<pre><code>##  [1] 230 246  46 371 232 257 316 291 228 172  36  97 222 215 256 478 424 188  50
## [20] 218</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="topic-05.html#cb28-1" aria-hidden="true" tabindex="-1"></a>  hist_li <span class="co"># drawn history (of observations)</span></span></code></pre></div>
<pre><code>## [[1]]
##     long.run short.run
## 229    7.439     7.963
## 230    6.808     6.892
## 
## [[2]]
##     long.run short.run
## 245    6.529     4.972
## 246    6.827     6.057
## 
## [[3]]
##    long.run short.run
## 45    2.462     1.196
## 46    2.440     1.261
## 
## [[4]]
##     long.run short.run
## 370   14.211    14.099
## 371   12.947    11.564
## 
## [[5]]
##     long.run short.run
## 231    6.835     6.655
## 232    7.714     7.527
## 
## [[6]]
##     long.run short.run
## 256    6.209     4.497
## 257    6.138     4.561
## 
## [[7]]
##     long.run short.run
## 315    7.424     5.407
## 316    7.449     5.511
## 
## [[8]]
##     long.run short.run
## 290    7.487     5.919
## 291    7.933     6.164
## 
## [[9]]
##     long.run short.run
## 227    7.016     7.843
## 228    7.323     7.937
## 
## [[10]]
##     long.run short.run
## 171    4.205     4.085
## 172    4.196     4.066
## 
## [[11]]
##    long.run short.run
## 35    2.753     1.755
## 36    2.483     1.665
## 
## [[12]]
##    long.run short.run
## 96    3.901     3.190
## 97    3.991     3.403
## 
## [[13]]
##     long.run short.run
## 221    6.575     6.599
## 222    6.588     7.672
## 
## [[14]]
##     long.run short.run
## 214    5.790     5.700
## 215    5.951     5.858
## 
## [[15]]
##     long.run short.run
## 255    6.216     5.004
## 256    6.209     4.497
## 
## [[16]]
##     long.run short.run
## 477    8.787     7.663
## 478    8.645     7.352
## 
## [[17]]
##     long.run short.run
## 423    7.434     6.723
## 424    7.475     6.493
## 
## [[18]]
##     long.run short.run
## 187    5.260     5.212
## 188    5.569     5.945
## 
## [[19]]
##    long.run short.run
## 49    2.651     1.473
## 50    2.713     1.821
## 
## [[20]]
##     long.run short.run
## 217    6.338     6.482
## 218    6.368     6.505</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="topic-05.html#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(shock_li)) {</span>
<span id="cb30-2"><a href="topic-05.html#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) {</span>
<span id="cb30-3"><a href="topic-05.html#cb30-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(seed)</span>
<span id="cb30-4"><a href="topic-05.html#cb30-4" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-5"><a href="topic-05.html#cb30-5" aria-hidden="true" tabindex="-1"></a>    samples_shock <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(n_used), <span class="at">size =</span> n.shock, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-6"><a href="topic-05.html#cb30-6" aria-hidden="true" tabindex="-1"></a>    shock_li <span class="ot">&lt;-</span> <span class="fu">lapply</span>(samples_shock, <span class="cf">function</span>(i) resids[i, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb30-7"><a href="topic-05.html#cb30-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb30-8"><a href="topic-05.html#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.list</span>(shock_li)) {</span>
<span id="cb30-9"><a href="topic-05.html#cb30-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;shock_li should be a list of vectors&quot;</span>)</span>
<span id="cb30-10"><a href="topic-05.html#cb30-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-11"><a href="topic-05.html#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">unique</span>(<span class="fu">sapply</span>(shock_li, nrow_length)) <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb30-12"><a href="topic-05.html#cb30-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;each element of shock_li should have length lags&quot;</span>)</span>
<span id="cb30-13"><a href="topic-05.html#cb30-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-14"><a href="topic-05.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-15"><a href="topic-05.html#cb30-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-16"><a href="topic-05.html#cb30-16" aria-hidden="true" tabindex="-1"></a>  samples_shock <span class="co"># index for shocks</span></span></code></pre></div>
<pre><code>##  [1]  42 116 322 258 287 233  35 315 336 121 193 226 384   9 314 131 338 239 459
## [20]  26</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="topic-05.html#cb32-1" aria-hidden="true" tabindex="-1"></a>  shock_li <span class="co"># drawn shocks (of residuals)</span></span></code></pre></div>
<pre><code>## [[1]]
##      long.run  short.run
## 42 0.07063028 0.05810492
## 
## [[2]]
##      long.run  short.run
## 116 0.0837377 0.02723194
## 
## [[3]]
##      long.run  short.run
## 322 0.1600378 0.06238084
## 
## [[4]]
##     long.run short.run
## 258 0.107415 0.3662107
## 
## [[5]]
##       long.run  short.run
## 287 0.05426965 -0.8464811
## 
## [[6]]
##       long.run  short.run
## 233 0.09884777 -0.2197618
## 
## [[7]]
##      long.run  short.run
## 35 0.01318768 -0.4128055
## 
## [[8]]
##        long.run  short.run
## 315 -0.05620185 0.05145813
## 
## [[9]]
##      long.run short.run
## 336 0.2313076 0.4009926
## 
## [[10]]
##       long.run  short.run
## 121 0.08461357 -0.1092067
## 
## [[11]]
##       long.run  short.run
## 193 -0.2964814 -0.5939019
## 
## [[12]]
##      long.run  short.run
## 226 0.2589402 0.09907444
## 
## [[13]]
##       long.run  short.run
## 384 -0.6926882 -0.6347714
## 
## [[14]]
##     long.run   short.run
## 9 0.01285355 -0.08894462
## 
## [[15]]
##       long.run   short.run
## 314 0.03242544 -0.01601598
## 
## [[16]]
##       long.run    short.run
## 131 0.05020388 -0.003953293
## 
## [[17]]
##      long.run short.run
## 338 0.1969015 0.3008423
## 
## [[18]]
##       long.run  short.run
## 239 -0.1573728 -0.7708211
## 
## [[19]]
##       long.run  short.run
## 459 -0.3930896 -0.1514014
## 
## [[20]]
##     long.run short.run
## 26 0.2334145 0.3064269</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="topic-05.html#cb34-1" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">hist =</span> hist_li, <span class="at">shock =</span> shock_li)</span>
<span id="cb34-2"><a href="topic-05.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  n_cases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(M)</span>
<span id="cb34-3"><a href="topic-05.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  shock_M <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, M<span class="sc">$</span>shock))</span>
<span id="cb34-4"><a href="topic-05.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(shock_M) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;shock_var&quot;</span>, <span class="fu">seq_len</span>(nVar), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb34-5"><a href="topic-05.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  hist_M <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="fu">lapply</span>(M<span class="sc">$</span>hist, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">as.matrix</span>(x)))))</span>
<span id="cb34-6"><a href="topic-05.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(hist_M) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;hist_x&quot;</span>, <span class="fu">rep</span>(<span class="fu">seq_len</span>(nVar), <span class="at">each =</span> n_start), <span class="st">&quot;_l&quot;</span>, <span class="fu">rep</span>(<span class="fu">seq_len</span>(n_start), <span class="at">times =</span> nVar), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb34-7"><a href="topic-05.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  rep_info <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">n_simu =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(M)), hist_M, shock_M)</span>
<span id="cb34-8"><a href="topic-05.html#cb34-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-9"><a href="topic-05.html#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sims &lt;- lapply(1:nrow(M), function(i) irf_1_shock_ave(object = object, shock = M$shock[[i]], hist = M$hist[[i]], n.ahead = n.ahead, R = R, seed = seed, ...))</span></span>
<span id="cb34-10"><a href="topic-05.html#cb34-10" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(M), <span class="cf">function</span>(i) tsDyn<span class="sc">:::</span><span class="fu">irf_1_shock_ave</span>(<span class="at">object =</span> object, <span class="at">shock =</span> M<span class="sc">$</span>shock[[i]], <span class="at">hist =</span> M<span class="sc">$</span>hist[[i]], <span class="at">n.ahead =</span> n.ahead, <span class="at">R =</span> R, <span class="at">seed =</span> seed))</span>
<span id="cb34-11"><a href="topic-05.html#cb34-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-12"><a href="topic-05.html#cb34-12" aria-hidden="true" tabindex="-1"></a>  sims[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>##    n.ahead       var    sim_1    sim_2
## 1        0  long.run 6.830732 6.760102
## 2        1  long.run 6.912236 6.837670
## 3        2  long.run 7.022135 6.946925
## 4        3  long.run 7.096530 7.021116
## 5        4  long.run 7.045230 6.969676
## 6        5  long.run 7.084742 7.009066
## 7        6  long.run 7.106775 7.030991
## 8        7  long.run 7.030499 6.954618
## 9        8  long.run 6.999202 6.923233
## 10       9  long.run 6.996096 6.920049
## 11      10  long.run 6.942700 6.866583
## 12       0 short.run 6.612258 6.554153
## 13       1 short.run 6.571324 6.486298
## 14       2 short.run 6.463519 6.376947
## 15       3 short.run 6.576965 6.491283
## 16       4 short.run 6.453543 6.368920
## 17       5 short.run 6.462221 6.378576
## 18       6 short.run 6.522968 6.440206
## 19       7 short.run 6.435781 6.353810
## 20       8 short.run 6.371803 6.290541
## 21       9 short.run 6.471180 6.390555
## 22      10 short.run 6.492899 6.412846</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="topic-05.html#cb36-1" aria-hidden="true" tabindex="-1"></a>  sims[[<span class="dv">400</span>]]</span></code></pre></div>
<pre><code>##    n.ahead       var    sim_1    sim_2
## 1        0  long.run 6.552920 6.319506
## 2        1  long.run 6.758050 6.508944
## 3        2  long.run 6.605362 6.352776
## 4        3  long.run 6.733731 6.479366
## 5        4  long.run 6.816287 6.560474
## 6        5  long.run 6.836568 6.579473
## 7        6  long.run 6.967177 6.708935
## 8        7  long.run 7.099084 6.839812
## 9        8  long.run 7.081889 6.821693
## 10       9  long.run 7.292642 7.031618
## 11      10  long.run 7.296592 7.034825
## 12       0 short.run 6.836132 6.529705
## 13       1 short.run 6.993065 6.602268
## 14       2 short.run 6.404504 6.017681
## 15       3 short.run 6.506164 6.131089
## 16       4 short.run 6.659036 6.295431
## 17       5 short.run 6.638631 6.285422
## 18       6 short.run 6.744711 6.400838
## 19       7 short.run 6.918352 6.582857
## 20       8 short.run 6.825850 6.497870
## 21       9 short.run 7.428718 7.107481
## 22      10 short.run 7.323497 7.008309</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="topic-05.html#cb38-1" aria-hidden="true" tabindex="-1"></a>  sims_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, sims)</span>
<span id="cb38-2"><a href="topic-05.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  n.ahead_here <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">head</span>(sims_df<span class="sc">$</span>n.ahead, <span class="dv">2</span> <span class="sc">*</span> (n.ahead <span class="sc">*</span> lag))))</span>
<span id="cb38-3"><a href="topic-05.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  sims_df<span class="sc">$</span>n_simu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq_len</span>(n_cases), <span class="at">each =</span> n.ahead_here <span class="sc">*</span> nVar)</span>
<span id="cb38-4"><a href="topic-05.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  sims_df<span class="sc">$</span>girf <span class="ot">&lt;-</span> <span class="fu">with</span>(sims_df, sim_1 <span class="sc">-</span> sim_2)</span>
<span id="cb38-5"><a href="topic-05.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-6"><a href="topic-05.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  sims_df2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(rep_info, sims_df, <span class="at">by =</span> <span class="st">&quot;n_simu&quot;</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-7"><a href="topic-05.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(sims_df2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GIRF_df&quot;</span>, <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb38-8"><a href="topic-05.html#cb38-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-9"><a href="topic-05.html#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sims_df2</span></span>
<span id="cb38-10"><a href="topic-05.html#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(sims_df2, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##    n_simu hist_x1_l1 hist_x1_l2 hist_x2_l1 hist_x2_l2 shock_var1 shock_var2
## 1       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 2       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 3       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 4       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 5       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 6       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 7       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 8       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 9       1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 10      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 11      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 12      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 13      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 14      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 15      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 16      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 17      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 18      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 19      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 20      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 21      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 22      1      7.439      6.808      7.963      6.892 0.07063028 0.05810492
## 23      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 24      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 25      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 26      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 27      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 28      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 29      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
## 30      2      6.529      6.827      4.972      6.057 0.07063028 0.05810492
##    n.ahead       var    sim_1    sim_2       girf
## 1        0  long.run 6.830732 6.760102 0.07063028
## 2        1  long.run 6.912236 6.837670 0.07456528
## 3        2  long.run 7.022135 6.946925 0.07521027
## 4        3  long.run 7.096530 7.021116 0.07541340
## 5        4  long.run 7.045230 6.969676 0.07555406
## 6        5  long.run 7.084742 7.009066 0.07567557
## 7        6  long.run 7.106775 7.030991 0.07578404
## 8        7  long.run 7.030499 6.954618 0.07588129
## 9        8  long.run 6.999202 6.923233 0.07596853
## 10       9  long.run 6.996096 6.920049 0.07604679
## 11      10  long.run 6.942700 6.866583 0.07611700
## 12       0 short.run 6.612258 6.554153 0.05810492
## 13       1 short.run 6.571324 6.486298 0.08502581
## 14       2 short.run 6.463519 6.376947 0.08657280
## 15       3 short.run 6.576965 6.491283 0.08568220
## 16       4 short.run 6.453543 6.368920 0.08462336
## 17       5 short.run 6.462221 6.378576 0.08364429
## 18       6 short.run 6.522968 6.440206 0.08276268
## 19       7 short.run 6.435781 6.353810 0.08197142
## 20       8 short.run 6.371803 6.290541 0.08126154
## 21       9 short.run 6.471180 6.390555 0.08062470
## 22      10 short.run 6.492899 6.412846 0.08005339
## 23       0  long.run 6.911683 6.841053 0.07063028
## 24       1  long.run 7.020203 6.945638 0.07456528
## 25       2  long.run 6.931175 6.855965 0.07521027
## 26       3  long.run 6.812433 6.737019 0.07541340
## 27       4  long.run 6.823608 6.748054 0.07555406
## 28       5  long.run 6.855322 6.779646 0.07567557
## 29       6  long.run 6.821889 6.746105 0.07578404
## 30       7  long.run 6.882666 6.806785 0.07588129</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="topic-05.html#cb40-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(sims_df2, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##      n_simu hist_x1_l1 hist_x1_l2 hist_x2_l1 hist_x2_l2 shock_var1 shock_var2
## 8771    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8772    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8773    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8774    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8775    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8776    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8777    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8778    399      2.651      2.713      1.473      1.821  0.2334145  0.3064269
## 8779    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8780    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8781    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8782    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8783    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8784    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8785    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8786    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8787    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8788    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8789    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8790    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8791    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8792    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8793    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8794    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8795    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8796    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8797    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8798    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8799    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
## 8800    400      6.338      6.368      6.482      6.505  0.2334145  0.3064269
##      n.ahead       var    sim_1    sim_2      girf
## 8771       3 short.run 2.454141 2.079066 0.3750751
## 8772       4 short.run 2.627428 2.263824 0.3636045
## 8773       5 short.run 2.816674 2.463464 0.3532096
## 8774       6 short.run 2.992350 2.648477 0.3438726
## 8775       7 short.run 2.903425 2.567930 0.3354950
## 8776       8 short.run 3.040565 2.712586 0.3279794
## 8777       9 short.run 3.195059 2.873822 0.3212371
## 8778      10 short.run 3.268482 2.953293 0.3151885
## 8779       0  long.run 6.552920 6.319506 0.2334145
## 8780       1  long.run 6.758050 6.508944 0.2491062
## 8781       2  long.run 6.605362 6.352776 0.2525860
## 8782       3  long.run 6.733731 6.479366 0.2543655
## 8783       4  long.run 6.816287 6.560474 0.2558129
## 8784       5  long.run 6.836568 6.579473 0.2570946
## 8785       6  long.run 6.967177 6.708935 0.2582425
## 8786       7  long.run 7.099084 6.839812 0.2592720
## 8787       8  long.run 7.081889 6.821693 0.2601956
## 8788       9  long.run 7.292642 7.031618 0.2610242
## 8789      10  long.run 7.296592 7.034825 0.2617675
## 8790       0 short.run 6.836132 6.529705 0.3064269
## 8791       1 short.run 6.993065 6.602268 0.3907978
## 8792       2 short.run 6.404504 6.017681 0.3868235
## 8793       3 short.run 6.506164 6.131089 0.3750751
## 8794       4 short.run 6.659036 6.295431 0.3636045
## 8795       5 short.run 6.638631 6.285422 0.3532096
## 8796       6 short.run 6.744711 6.400838 0.3438726
## 8797       7 short.run 6.918352 6.582857 0.3354950
## 8798       8 short.run 6.825850 6.497870 0.3279794
## 8799       9 short.run 7.428718 7.107481 0.3212371
## 8800      10 short.run 7.323497 7.008309 0.3151885</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="topic-05.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb42-2"><a href="topic-05.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="topic-05.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCKER</span></span>
<span id="cb42-4"><a href="topic-05.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-5"><a href="topic-05.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># tsDyn_GIRF_setar_fun no 02 ----</span></span>
<span id="cb42-6"><a href="topic-05.html#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="topic-05.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tsDyn_GIRF_setar_fun - function (object, n.ahead = 10, seed = NULL, n.hist = 20, n.shock = 20, </span></span>
<span id="cb42-8"><a href="topic-05.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  R = 10, hist_li = NULL, shock_li = NULL, ...) {</span></span>
<span id="cb42-9"><a href="topic-05.html#cb42-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-10"><a href="topic-05.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb42-11"><a href="topic-05.html#cb42-11" aria-hidden="true" tabindex="-1"></a>  object <span class="ot">&lt;-</span> vecm.tsdyn</span>
<span id="cb42-12"><a href="topic-05.html#cb42-12" aria-hidden="true" tabindex="-1"></a>  n.ahead <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb42-13"><a href="topic-05.html#cb42-13" aria-hidden="true" tabindex="-1"></a>  seed <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb42-14"><a href="topic-05.html#cb42-14" aria-hidden="true" tabindex="-1"></a>  n.hist <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb42-15"><a href="topic-05.html#cb42-15" aria-hidden="true" tabindex="-1"></a>  n.shock <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb42-16"><a href="topic-05.html#cb42-16" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb42-17"><a href="topic-05.html#cb42-17" aria-hidden="true" tabindex="-1"></a>  hist_li <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb42-18"><a href="topic-05.html#cb42-18" aria-hidden="true" tabindex="-1"></a>  shock_li <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb42-19"><a href="topic-05.html#cb42-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-20"><a href="topic-05.html#cb42-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-21"><a href="topic-05.html#cb42-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-22"><a href="topic-05.html#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lag &lt;- tsDyn:::get_lag(object)</span></span>
<span id="cb42-23"><a href="topic-05.html#cb42-23" aria-hidden="true" tabindex="-1"></a>  lag <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_lag.nlVar</span>(object)</span>
<span id="cb42-24"><a href="topic-05.html#cb42-24" aria-hidden="true" tabindex="-1"></a>  n_start <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">inherits</span>(object, <span class="fu">c</span>(<span class="st">&quot;VECM&quot;</span>, <span class="st">&quot;TVECM&quot;</span>)), lag <span class="sc">+</span> <span class="dv">1</span>, lag)</span>
<span id="cb42-25"><a href="topic-05.html#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x_orig &lt;- get_data_orig(object, as.df = TRUE)</span></span>
<span id="cb42-26"><a href="topic-05.html#cb42-26" aria-hidden="true" tabindex="-1"></a>  x_orig <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_data_orig.nlVar</span>(object, <span class="at">as.df =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-27"><a href="topic-05.html#cb42-27" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x_orig)</span>
<span id="cb42-28"><a href="topic-05.html#cb42-28" aria-hidden="true" tabindex="-1"></a>  resids <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">residuals</span>(object, <span class="at">initVal =</span> <span class="cn">FALSE</span>))</span>
<span id="cb42-29"><a href="topic-05.html#cb42-29" aria-hidden="true" tabindex="-1"></a>  n_used <span class="ot">&lt;-</span> <span class="fu">nrow</span>(resids)</span>
<span id="cb42-30"><a href="topic-05.html#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nVar &lt;- get_nVar(object)</span></span>
<span id="cb42-31"><a href="topic-05.html#cb42-31" aria-hidden="true" tabindex="-1"></a>  nVar <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_nVar.nlVar</span>(object)</span>
<span id="cb42-32"><a href="topic-05.html#cb42-32" aria-hidden="true" tabindex="-1"></a>  sample_hist <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb42-33"><a href="topic-05.html#cb42-33" aria-hidden="true" tabindex="-1"></a>    hist_M <span class="ot">&lt;-</span> <span class="fu">sample</span>(n_start<span class="sc">:</span>N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-34"><a href="topic-05.html#cb42-34" aria-hidden="true" tabindex="-1"></a>    (hist_M <span class="sc">-</span> n_start <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>hist_M</span>
<span id="cb42-35"><a href="topic-05.html#cb42-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-36"><a href="topic-05.html#cb42-36" aria-hidden="true" tabindex="-1"></a>  nrow_length <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb42-37"><a href="topic-05.html#cb42-37" aria-hidden="true" tabindex="-1"></a>    nr <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb42-38"><a href="topic-05.html#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(nr)) {</span>
<span id="cb42-39"><a href="topic-05.html#cb42-39" aria-hidden="true" tabindex="-1"></a>      nr <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb42-40"><a href="topic-05.html#cb42-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-41"><a href="topic-05.html#cb42-41" aria-hidden="true" tabindex="-1"></a>    nr</span>
<span id="cb42-42"><a href="topic-05.html#cb42-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-43"><a href="topic-05.html#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(hist_li)) {</span>
<span id="cb42-44"><a href="topic-05.html#cb42-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) {</span>
<span id="cb42-45"><a href="topic-05.html#cb42-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(seed)</span>
<span id="cb42-46"><a href="topic-05.html#cb42-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-47"><a href="topic-05.html#cb42-47" aria-hidden="true" tabindex="-1"></a>    samples_hist <span class="ot">&lt;-</span> <span class="fu">sample</span>(n_start<span class="sc">:</span>N, <span class="at">size =</span> n.hist, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-48"><a href="topic-05.html#cb42-48" aria-hidden="true" tabindex="-1"></a>    hist_li <span class="ot">&lt;-</span> <span class="fu">lapply</span>(samples_hist, <span class="cf">function</span>(i) x_orig[(i <span class="sc">-</span> n_start <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>i, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb42-49"><a href="topic-05.html#cb42-49" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-50"><a href="topic-05.html#cb42-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.list</span>(hist_li)) {</span>
<span id="cb42-51"><a href="topic-05.html#cb42-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;hist_li should be a list of vectors/matrices&quot;</span>)</span>
<span id="cb42-52"><a href="topic-05.html#cb42-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-53"><a href="topic-05.html#cb42-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">unique</span>(<span class="fu">sapply</span>(hist_li, nrow_length)) <span class="sc">!=</span> n_start) {</span>
<span id="cb42-54"><a href="topic-05.html#cb42-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;each element of hist_li should have length lags (+1 if VECM)&quot;</span>)</span>
<span id="cb42-55"><a href="topic-05.html#cb42-55" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-56"><a href="topic-05.html#cb42-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-57"><a href="topic-05.html#cb42-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(shock_li)) {</span>
<span id="cb42-58"><a href="topic-05.html#cb42-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) {</span>
<span id="cb42-59"><a href="topic-05.html#cb42-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(seed)</span>
<span id="cb42-60"><a href="topic-05.html#cb42-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-61"><a href="topic-05.html#cb42-61" aria-hidden="true" tabindex="-1"></a>    samples_shock <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(n_used), <span class="at">size =</span> n.shock, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-62"><a href="topic-05.html#cb42-62" aria-hidden="true" tabindex="-1"></a>    shock_li <span class="ot">&lt;-</span> <span class="fu">lapply</span>(samples_shock, <span class="cf">function</span>(i) resids[i, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb42-63"><a href="topic-05.html#cb42-63" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-64"><a href="topic-05.html#cb42-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.list</span>(shock_li)) {</span>
<span id="cb42-65"><a href="topic-05.html#cb42-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;shock_li should be a list of vectors&quot;</span>)</span>
<span id="cb42-66"><a href="topic-05.html#cb42-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-67"><a href="topic-05.html#cb42-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">unique</span>(<span class="fu">sapply</span>(shock_li, nrow_length)) <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb42-68"><a href="topic-05.html#cb42-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;each element of shock_li should have length lags&quot;</span>)</span>
<span id="cb42-69"><a href="topic-05.html#cb42-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-70"><a href="topic-05.html#cb42-70" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-71"><a href="topic-05.html#cb42-71" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">hist =</span> hist_li, <span class="at">shock =</span> shock_li)</span>
<span id="cb42-72"><a href="topic-05.html#cb42-72" aria-hidden="true" tabindex="-1"></a>  n_cases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(M)</span>
<span id="cb42-73"><a href="topic-05.html#cb42-73" aria-hidden="true" tabindex="-1"></a>  shock_M <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, M<span class="sc">$</span>shock))</span>
<span id="cb42-74"><a href="topic-05.html#cb42-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(shock_M) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;shock_var&quot;</span>, <span class="fu">seq_len</span>(nVar), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb42-75"><a href="topic-05.html#cb42-75" aria-hidden="true" tabindex="-1"></a>  hist_M <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="fu">lapply</span>(M<span class="sc">$</span>hist, <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="fu">as.matrix</span>(x)))))</span>
<span id="cb42-76"><a href="topic-05.html#cb42-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(hist_M) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;hist_x&quot;</span>, <span class="fu">rep</span>(<span class="fu">seq_len</span>(nVar), <span class="at">each =</span> n_start), <span class="st">&quot;_l&quot;</span>, <span class="fu">rep</span>(<span class="fu">seq_len</span>(n_start), <span class="at">times =</span> nVar), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb42-77"><a href="topic-05.html#cb42-77" aria-hidden="true" tabindex="-1"></a>  rep_info <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">n_simu =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(M)), hist_M, shock_M)</span>
<span id="cb42-78"><a href="topic-05.html#cb42-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sims &lt;- lapply(1:nrow(M), function(i) irf_1_shock_ave(object = object, shock = M$shock[[i]], hist = M$hist[[i]], n.ahead = n.ahead, R = R, seed = seed, ...))</span></span>
<span id="cb42-79"><a href="topic-05.html#cb42-79" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(M), <span class="cf">function</span>(i) tsDyn<span class="sc">:::</span><span class="fu">irf_1_shock_ave</span>(<span class="at">object =</span> object, <span class="at">shock =</span> M<span class="sc">$</span>shock[[i]], <span class="at">hist =</span> M<span class="sc">$</span>hist[[i]], <span class="at">n.ahead =</span> n.ahead, <span class="at">R =</span> R, <span class="at">seed =</span> seed))</span>
<span id="cb42-80"><a href="topic-05.html#cb42-80" aria-hidden="true" tabindex="-1"></a>  sims_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, sims)</span>
<span id="cb42-81"><a href="topic-05.html#cb42-81" aria-hidden="true" tabindex="-1"></a>  n.ahead_here <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">head</span>(sims_df<span class="sc">$</span>n.ahead, <span class="dv">2</span> <span class="sc">*</span> (n.ahead <span class="sc">*</span> lag))))</span>
<span id="cb42-82"><a href="topic-05.html#cb42-82" aria-hidden="true" tabindex="-1"></a>  sims_df<span class="sc">$</span>n_simu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq_len</span>(n_cases), <span class="at">each =</span> n.ahead_here <span class="sc">*</span> nVar)</span>
<span id="cb42-83"><a href="topic-05.html#cb42-83" aria-hidden="true" tabindex="-1"></a>  sims_df<span class="sc">$</span>girf <span class="ot">&lt;-</span> <span class="fu">with</span>(sims_df, sim_1 <span class="sc">-</span> sim_2)</span>
<span id="cb42-84"><a href="topic-05.html#cb42-84" aria-hidden="true" tabindex="-1"></a>  sims_df2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(rep_info, sims_df, <span class="at">by =</span> <span class="st">&quot;n_simu&quot;</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-85"><a href="topic-05.html#cb42-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(sims_df2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GIRF_df&quot;</span>, <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb42-86"><a href="topic-05.html#cb42-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-87"><a href="topic-05.html#cb42-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sims_df2</span></span>
<span id="cb42-88"><a href="topic-05.html#cb42-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(sims_df2, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##    n_simu hist_x1_l1 hist_x1_l2 hist_x2_l1 hist_x2_l2 shock_var1 shock_var2
## 1       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 2       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 3       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 4       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 5       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 6       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 7       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 8       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 9       1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 10      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 11      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 12      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 13      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 14      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 15      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 16      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 17      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 18      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 19      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 20      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 21      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 22      1      2.730      2.759      2.215      2.132  0.2507766  0.5192421
## 23      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 24      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 25      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 26      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 27      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 28      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 29      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
## 30      2     11.532     11.855      9.634      9.985  0.2507766  0.5192421
##    n.ahead       var     sim_1     sim_2      girf
## 1        0  long.run  2.905852  2.655076 0.2507766
## 2        1  long.run  2.729036  2.456936 0.2720995
## 3        2  long.run  2.703515  2.425437 0.2780775
## 4        3  long.run  2.728862  2.447032 0.2818301
## 5        4  long.run  2.719724  2.434706 0.2850171
## 6        5  long.run  2.683838  2.395982 0.2878560
## 7        6  long.run  2.634190  2.343790 0.2904005
## 8        7  long.run  2.683277  2.390595 0.2926829
## 9        8  long.run  2.588735  2.294005 0.2947304
## 10       9  long.run  2.545680  2.249113 0.2965672
## 11      10  long.run  2.521914  2.223699 0.2982150
## 12       0 short.run  2.547868  2.028626 0.5192421
## 13       1 short.run  2.299287  1.697031 0.6022556
## 14       2 short.run  2.288231  1.705338 0.5828931
## 15       3 short.run  2.404816  1.849170 0.5556458
## 16       4 short.run  2.221844  1.691762 0.5300818
## 17       5 short.run  2.245837  1.738814 0.5070224
## 18       6 short.run  2.247367  1.761045 0.4863217
## 19       7 short.run  2.277478  1.809728 0.4677495
## 20       8 short.run  2.119958  1.668870 0.4510882
## 21       9 short.run  2.174563  1.738422 0.4361414
## 22      10 short.run  2.290229  1.867497 0.4227326
## 23       0  long.run 12.199097 11.948321 0.2507766
## 24       1  long.run 12.224232 11.952132 0.2720995
## 25       2  long.run 12.108769 11.830691 0.2780775
## 26       3  long.run 12.003876 11.722046 0.2818301
## 27       4  long.run 12.121728 11.836711 0.2850171
## 28       5  long.run 12.004049 11.716193 0.2878560
## 29       6  long.run 11.852378 11.561977 0.2904005
## 30       7  long.run 11.797255 11.504572 0.2926829</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="topic-05.html#cb44-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(sims_df2, <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##      n_simu hist_x1_l1 hist_x1_l2 hist_x2_l1 hist_x2_l2 shock_var1 shock_var2
## 8771    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8772    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8773    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8774    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8775    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8776    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8777    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8778    399      4.935      5.110      5.055      5.018 0.08666644  0.1122016
## 8779    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8780    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8781    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8782    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8783    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8784    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8785    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8786    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8787    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8788    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8789    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8790    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8791    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8792    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8793    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8794    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8795    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8796    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8797    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8798    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8799    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
## 8800    400      7.427      7.479      7.128      6.150 0.08666644  0.1122016
##      n.ahead       var    sim_1    sim_2       girf
## 8771       3 short.run 5.184390 5.046390 0.13799998
## 8772       4 short.run 4.909614 4.775763 0.13385066
## 8773       5 short.run 4.640142 4.510052 0.13008957
## 8774       6 short.run 4.482839 4.356127 0.12671114
## 8775       7 short.run 4.375453 4.251773 0.12367986
## 8776       8 short.run 3.999066 3.878106 0.12096044
## 8777       9 short.run 3.780254 3.661734 0.11852085
## 8778      10 short.run 4.115547 3.999214 0.11633229
## 8779       0  long.run 7.389192 7.302526 0.08666644
## 8780       1  long.run 7.355652 7.263196 0.09245577
## 8781       2  long.run 7.391629 7.297900 0.09372925
## 8782       3  long.run 7.420072 7.325697 0.09437473
## 8783       4  long.run 7.388524 7.293625 0.09489863
## 8784       5  long.run 7.244864 7.149502 0.09536240
## 8785       6  long.run 7.158300 7.062522 0.09577775
## 8786       7  long.run 7.224231 7.128081 0.09615029
## 8787       8  long.run 7.365989 7.269504 0.09648448
## 8788       9  long.run 7.470244 7.373460 0.09678428
## 8789      10  long.run 7.394654 7.297601 0.09705323
## 8790       0 short.run 6.043060 5.930859 0.11220161
## 8791       1 short.run 6.065089 5.921497 0.14359161
## 8792       2 short.run 6.096903 5.954662 0.14224099
## 8793       3 short.run 6.216414 6.078414 0.13799998
## 8794       4 short.run 6.231008 6.097157 0.13385066
## 8795       5 short.run 6.146681 6.016591 0.13008957
## 8796       6 short.run 5.946970 5.820259 0.12671114
## 8797       7 short.run 5.941816 5.818136 0.12367986
## 8798       8 short.run 6.094679 5.973719 0.12096044
## 8799       9 short.run 6.467200 6.348679 0.11852085
## 8800      10 short.run 6.605892 6.489560 0.11633229</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="topic-05.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
<p>Definition generalized impulse response functions (GIRs) based on Pesaran (2015)</p>
<p>General</p>
<p><span class="math display">\[\begin{align*}
GI_{y}\left(n, u_{t}^{0}, \Omega_{t-1}^{0}\right) = \text{E}\left(y_{t+n}|u_{t}=u_{t}^{0}, \Omega_{t-1}^{0}\right) - \text{E}\left(y_{t+n}|\Omega_{t-1}^{0}\right)
\end{align*}\]</span></p>
<p>Particular VAR</p>
<p><span class="math display">\[\begin{align*}
GI_{y}\left(n, u_{t}^{0}, \Omega_{t-1}^{0}\right) = A_{n}u_{t}^{0}
\end{align*}\]</span></p>
<p>which is independent of the “history” of the process.</p>
<p>The choice of the vector shocks <span class="math inline">\(u_{t}^{0}\)</span> is arbitrary.</p>
<p>One possibility is to consider a large number of likely shocks and then examine the empirical distribution function of <span class="math inline">\(A_{n}u_{t}^{0}\)</span> for all these shocks.</p>
<p>In the case where <span class="math inline">\(u_{t}^{0}\)</span> is drawn from the same distribution as <span class="math inline">\(u_{t}\)</span>, namely a multivariate normal distribution with zero means and a constant covariance matrix <span class="math inline">\(\Sigma\)</span> we have the analyitical result</p>
<p><span class="math display">\[\begin{align*}
GI_{y}\left(n, u_{t}^{0}, \Omega_{t-1}^{0}\right) \sim N\left(0, A_{n} \Sigma A_{n}^{&#39;}\right)
\end{align*}\]</span></p>
<p>Persistence profiles (general on X)</p>
<p>Lee and Pesaran (1993) refer to
H,(n), seen as a function of n, as the (unscaled) ‘persistence profile’, character-
izing the time profile of the effects of the system-wide shocks on X,.</p>
<p>Persitence profiles (specific on Z)</p>
<p>The above concept of the persistence profile can be readily extended to
cointegrated systems. The (unscaled) persistence profile of the cointegrating
relations 2, = P’X, is given by</p>
<ul>
<li><code>n.hist</code>:
<ul>
<li>The number of past histories to consider. Should be high, ideally size of data (minus lags).</li>
<li>For VAR models …</li>
</ul></li>
</ul>
<p>Some interpretation:</p>
<ul>
<li>400 simulations <em>times</em> 11 steps <em>times</em> 2 shock variables <em>equals</em> 8800 rows</li>
<li><code>girf = sim_1 - sim_2</code></li>
</ul>
<p>Check plot methods:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="topic-05.html#cb47-1" aria-hidden="true" tabindex="-1"></a>tsDyn_plot_GIRF_df <span class="ot">&lt;-</span> <span class="cf">function</span> (x, <span class="at">plot_type =</span> <span class="fu">c</span>(<span class="st">&quot;density&quot;</span>, <span class="st">&quot;line&quot;</span>), <span class="at">n.ahead =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="at">var =</span> <span class="fu">unique</span>(x<span class="sc">$</span>var)[<span class="dv">1</span>], <span class="at">n_simu =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ...) {</span>
<span id="cb47-2"><a href="topic-05.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-3"><a href="topic-05.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb47-4"><a href="topic-05.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sims_df2</span>
<span id="cb47-5"><a href="topic-05.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-6"><a href="topic-05.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  plot_type <span class="ot">&lt;-</span> <span class="st">&quot;density&quot;</span></span>
<span id="cb47-7"><a href="topic-05.html#cb47-7" aria-hidden="true" tabindex="-1"></a>  n.ahead <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb47-8"><a href="topic-05.html#cb47-8" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">unique</span>(x<span class="sc">$</span>var)[<span class="dv">1</span>]</span>
<span id="cb47-9"><a href="topic-05.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  n_simu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb47-10"><a href="topic-05.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-11"><a href="topic-05.html#cb47-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-12"><a href="topic-05.html#cb47-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-13"><a href="topic-05.html#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot_type &lt;- match.arg(plot_type)</span></span>
<span id="cb47-14"><a href="topic-05.html#cb47-14" aria-hidden="true" tabindex="-1"></a>  plot_type <span class="ot">&lt;-</span> plot_type</span>
<span id="cb47-15"><a href="topic-05.html#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (plot_type <span class="sc">==</span> <span class="st">&quot;density&quot;</span>) {</span>
<span id="cb47-16"><a href="topic-05.html#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot_GIRF_dens(x = x, n.ahead = n.ahead, var = var, ...)</span></span>
<span id="cb47-17"><a href="topic-05.html#cb47-17" aria-hidden="true" tabindex="-1"></a>    tsDyn<span class="sc">:::</span><span class="fu">plot_GIRF_dens</span>(<span class="at">x =</span> x, <span class="at">n.ahead =</span> n.ahead, <span class="at">var =</span> var)</span>
<span id="cb47-18"><a href="topic-05.html#cb47-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (plot_type <span class="sc">==</span> <span class="st">&quot;line&quot;</span>) {</span>
<span id="cb47-19"><a href="topic-05.html#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot_GIRF_line(x = x, n_simu = n_simu, var = var, ...)</span></span>
<span id="cb47-20"><a href="topic-05.html#cb47-20" aria-hidden="true" tabindex="-1"></a>    tsDyn<span class="sc">:::</span><span class="fu">plot_GIRF_line</span>(<span class="at">x =</span> x, <span class="at">n_simu =</span> n_simu, <span class="at">var =</span> var)</span>
<span id="cb47-21"><a href="topic-05.html#cb47-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-22"><a href="topic-05.html#cb47-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-23"><a href="topic-05.html#cb47-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-24"><a href="topic-05.html#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="topic-05.html#cb47-25" aria-hidden="true" tabindex="-1"></a>tsDyn_plot_GIRF_line <span class="ot">&lt;-</span> <span class="cf">function</span> (x, <span class="at">n_simu =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">var =</span> <span class="fu">unique</span>(x<span class="sc">$</span>var)[<span class="dv">1</span>], <span class="at">add_legend =</span> <span class="cn">TRUE</span>, ...) {</span>
<span id="cb47-26"><a href="topic-05.html#cb47-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-27"><a href="topic-05.html#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb47-28"><a href="topic-05.html#cb47-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sims_df2</span>
<span id="cb47-29"><a href="topic-05.html#cb47-29" aria-hidden="true" tabindex="-1"></a>  n_simu <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb47-30"><a href="topic-05.html#cb47-30" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">unique</span>(x<span class="sc">$</span>var)[<span class="dv">1</span>]</span>
<span id="cb47-31"><a href="topic-05.html#cb47-31" aria-hidden="true" tabindex="-1"></a>  add_legend <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb47-32"><a href="topic-05.html#cb47-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-33"><a href="topic-05.html#cb47-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-34"><a href="topic-05.html#cb47-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-35"><a href="topic-05.html#cb47-35" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> x[x<span class="sc">$</span>n_simu <span class="sc">%in%</span> n_simu <span class="sc">&amp;</span> x<span class="sc">$</span>var <span class="sc">%in%</span> var, <span class="fu">c</span>(<span class="st">&quot;n_simu&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;n.ahead&quot;</span>, <span class="st">&quot;girf&quot;</span>)]</span>
<span id="cb47-36"><a href="topic-05.html#cb47-36" aria-hidden="true" tabindex="-1"></a>  df_w <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">&quot;n.ahead&quot;</span>, <span class="st">&quot;var&quot;</span>), <span class="at">timevar =</span> <span class="st">&quot;n_simu&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;wide&quot;</span>, <span class="at">v.names =</span> <span class="st">&quot;girf&quot;</span>)</span>
<span id="cb47-37"><a href="topic-05.html#cb47-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df_w) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;girf</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;n_simu: &quot;</span>, <span class="fu">colnames</span>(df_w))</span>
<span id="cb47-38"><a href="topic-05.html#cb47-38" aria-hidden="true" tabindex="-1"></a>  df_w2 <span class="ot">&lt;-</span> df_w[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb47-39"><a href="topic-05.html#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot(NA, xlim = range(df$n.ahead), ylim = range(df$girf), ylab = &quot;GIRF&quot;, xlab = &quot;n.ahead&quot;, ...)</span></span>
<span id="cb47-40"><a href="topic-05.html#cb47-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">xlim =</span> <span class="fu">range</span>(df<span class="sc">$</span>n.ahead), <span class="at">ylim =</span> <span class="fu">range</span>(df<span class="sc">$</span>girf), <span class="at">ylab =</span> <span class="st">&quot;GIRF&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;n.ahead&quot;</span>)</span>
<span id="cb47-41"><a href="topic-05.html#cb47-41" aria-hidden="true" tabindex="-1"></a>  invisible <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(df_w2), <span class="cf">function</span>(x) <span class="fu">lines</span>(<span class="at">x =</span> df_w<span class="sc">$</span>n.ahead, <span class="at">y =</span> df_w2[, x], <span class="at">col =</span> x))</span>
<span id="cb47-42"><a href="topic-05.html#cb47-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add_legend) {</span>
<span id="cb47-43"><a href="topic-05.html#cb47-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">colnames</span>(df_w2), <span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_w2))</span>
<span id="cb47-44"><a href="topic-05.html#cb47-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-45"><a href="topic-05.html#cb47-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-46"><a href="topic-05.html#cb47-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-47"><a href="topic-05.html#cb47-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-48"><a href="topic-05.html#cb47-48" aria-hidden="true" tabindex="-1"></a>tsDyn_plot_GIRF_dens <span class="ot">&lt;-</span> <span class="cf">function</span> (x, <span class="at">n.ahead =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="at">var =</span> <span class="fu">unique</span>(x<span class="sc">$</span>var)[<span class="dv">1</span>], <span class="at">add_legend =</span> <span class="cn">TRUE</span>, ...) {</span>
<span id="cb47-49"><a href="topic-05.html#cb47-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-50"><a href="topic-05.html#cb47-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb47-51"><a href="topic-05.html#cb47-51" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sims_df2</span>
<span id="cb47-52"><a href="topic-05.html#cb47-52" aria-hidden="true" tabindex="-1"></a>  n.ahead <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb47-53"><a href="topic-05.html#cb47-53" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">unique</span>(x<span class="sc">$</span>var)[<span class="dv">1</span>]</span>
<span id="cb47-54"><a href="topic-05.html#cb47-54" aria-hidden="true" tabindex="-1"></a>  add_legend <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb47-55"><a href="topic-05.html#cb47-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-56"><a href="topic-05.html#cb47-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-57"><a href="topic-05.html#cb47-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-58"><a href="topic-05.html#cb47-58" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> x[x<span class="sc">$</span>n.ahead <span class="sc">%in%</span> n.ahead <span class="sc">&amp;</span> x<span class="sc">$</span>var <span class="sc">%in%</span> var, <span class="fu">c</span>(<span class="st">&quot;n_simu&quot;</span>, <span class="st">&quot;var&quot;</span>, <span class="st">&quot;n.ahead&quot;</span>, <span class="st">&quot;girf&quot;</span>)]</span>
<span id="cb47-59"><a href="topic-05.html#cb47-59" aria-hidden="true" tabindex="-1"></a>  df_w <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df, <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">&quot;n_simu&quot;</span>, <span class="st">&quot;var&quot;</span>), <span class="at">timevar =</span> <span class="st">&quot;n.ahead&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;wide&quot;</span>, <span class="at">v.names =</span> <span class="st">&quot;girf&quot;</span>)</span>
<span id="cb47-60"><a href="topic-05.html#cb47-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df_w) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;girf</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;n.ahead: &quot;</span>, <span class="fu">colnames</span>(df_w))</span>
<span id="cb47-61"><a href="topic-05.html#cb47-61" aria-hidden="true" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> <span class="fu">apply</span>(df_w[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="dv">2</span>, density)</span>
<span id="cb47-62"><a href="topic-05.html#cb47-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot(NA, xlim = range(sapply(dens, &quot;[&quot;, &quot;x&quot;)), </span></span>
<span id="cb47-63"><a href="topic-05.html#cb47-63" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     ylim = range(sapply(dens, &quot;[&quot;, &quot;y&quot;)), ylab = &quot;GIRF&quot;, </span></span>
<span id="cb47-64"><a href="topic-05.html#cb47-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     xlab = &quot;Density&quot;, ...)</span></span>
<span id="cb47-65"><a href="topic-05.html#cb47-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="cn">NA</span>, <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">sapply</span>(dens, <span class="st">&quot;[&quot;</span>, <span class="st">&quot;x&quot;</span>)), </span>
<span id="cb47-66"><a href="topic-05.html#cb47-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">sapply</span>(dens, <span class="st">&quot;[&quot;</span>, <span class="st">&quot;y&quot;</span>)), <span class="at">ylab =</span> <span class="st">&quot;GIRF&quot;</span>, </span>
<span id="cb47-67"><a href="topic-05.html#cb47-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb47-68"><a href="topic-05.html#cb47-68" aria-hidden="true" tabindex="-1"></a>  invisible <span class="ot">&lt;-</span> <span class="fu">mapply</span>(lines, dens, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dens))</span>
<span id="cb47-69"><a href="topic-05.html#cb47-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add_legend) {</span>
<span id="cb47-70"><a href="topic-05.html#cb47-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">names</span>(dens), <span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dens))</span>
<span id="cb47-71"><a href="topic-05.html#cb47-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-72"><a href="topic-05.html#cb47-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-73"><a href="topic-05.html#cb47-73" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr>
<p>Step x: Call function <code>tsDyn:::irf_1_shock_ave()</code></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="topic-05.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tsDyn_irf_1_shock_ave &lt;- function (object, shock, hist, R = 10, n.ahead = 10, innov = NULL, </span></span>
<span id="cb48-2"><a href="topic-05.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    shock_both = TRUE, returnStarting = FALSE, add.regime = FALSE, </span></span>
<span id="cb48-3"><a href="topic-05.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    seed = NULL) {</span></span>
<span id="cb48-4"><a href="topic-05.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5"><a href="topic-05.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb48-6"><a href="topic-05.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-7"><a href="topic-05.html#cb48-7" aria-hidden="true" tabindex="-1"></a>  object <span class="ot">&lt;-</span> vecm.tsdyn</span>
<span id="cb48-8"><a href="topic-05.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  shock <span class="ot">&lt;-</span> M<span class="sc">$</span>shock[[i]]</span>
<span id="cb48-9"><a href="topic-05.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  hist <span class="ot">&lt;-</span> M<span class="sc">$</span>hist[[i]]</span>
<span id="cb48-10"><a href="topic-05.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  n.ahead <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb48-11"><a href="topic-05.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb48-12"><a href="topic-05.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  seed <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-13"><a href="topic-05.html#cb48-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-14"><a href="topic-05.html#cb48-14" aria-hidden="true" tabindex="-1"></a>  innov <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-15"><a href="topic-05.html#cb48-15" aria-hidden="true" tabindex="-1"></a>  shock_both <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb48-16"><a href="topic-05.html#cb48-16" aria-hidden="true" tabindex="-1"></a>  returnStarting <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb48-17"><a href="topic-05.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  add.regime <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb48-18"><a href="topic-05.html#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="topic-05.html#cb48-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-20"><a href="topic-05.html#cb48-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-21"><a href="topic-05.html#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) {</span>
<span id="cb48-22"><a href="topic-05.html#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb48-23"><a href="topic-05.html#cb48-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-24"><a href="topic-05.html#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># out &lt;- replicate(R, irf_1_shock(object = object, shock = shock, </span></span>
<span id="cb48-25"><a href="topic-05.html#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                 hist = hist, n.ahead = n.ahead, innov = innov, shock_both = shock_both, </span></span>
<span id="cb48-26"><a href="topic-05.html#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                 returnStarting = returnStarting, add.regime = add.regime), </span></span>
<span id="cb48-27"><a href="topic-05.html#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                  simplify = FALSE)</span></span>
<span id="cb48-28"><a href="topic-05.html#cb48-28" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, tsDyn<span class="sc">:::</span><span class="fu">irf_1_shock</span>(<span class="at">object =</span> object, <span class="at">shock =</span> shock, </span>
<span id="cb48-29"><a href="topic-05.html#cb48-29" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">hist =</span> hist, <span class="at">n.ahead =</span> n.ahead, <span class="at">innov =</span> innov, <span class="at">shock_both =</span> shock_both, </span>
<span id="cb48-30"><a href="topic-05.html#cb48-30" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">returnStarting =</span> returnStarting, <span class="at">add.regime =</span> add.regime), </span>
<span id="cb48-31"><a href="topic-05.html#cb48-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-32"><a href="topic-05.html#cb48-32" aria-hidden="true" tabindex="-1"></a>  out_M <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, out)</span>
<span id="cb48-33"><a href="topic-05.html#cb48-33" aria-hidden="true" tabindex="-1"></a>  out_M_means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(out_M[, <span class="fu">grep</span>(<span class="st">&quot;sim|regime&quot;</span>, <span class="fu">colnames</span>(out_M))], <span class="fu">list</span>(<span class="at">n.ahead =</span> out_M<span class="sc">$</span>n.ahead, <span class="at">var =</span> out_M<span class="sc">$</span>var), mean)</span>
<span id="cb48-34"><a href="topic-05.html#cb48-34" aria-hidden="true" tabindex="-1"></a>  out_M_means</span></code></pre></div>
<pre><code>##    n.ahead       var    sim_1    sim_2
## 1        0  long.run 9.056020 9.323315
## 2        1  long.run 9.074386 9.361219
## 3        2  long.run 8.784565 9.076169
## 4        3  long.run 8.812084 9.106373
## 5        4  long.run 8.799752 9.096271
## 6        5  long.run 8.881730 9.180231
## 7        6  long.run 8.986100 9.286376
## 8        7  long.run 8.938590 9.240458
## 9        8  long.run 8.846973 9.150270
## 10       9  long.run 8.916755 9.221333
## 11      10  long.run 8.972200 9.277927
## 12       0 short.run 7.376666 7.794324
## 13       1 short.run 7.600698 8.112293
## 14       2 short.run 7.104135 7.605876
## 15       3 short.run 7.047400 7.530550
## 16       4 short.run 7.130903 7.596266
## 17       5 short.run 7.414129 7.863411
## 18       6 short.run 7.698557 8.133399
## 19       7 short.run 7.728154 8.150041
## 20       8 short.run 7.707704 8.117967
## 21       9 short.run 7.879125 8.278962
## 22      10 short.run 8.004127 8.394609</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="topic-05.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
<p>Step x: Call function <code>tsDyn:::irf_1_shock()</code></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="topic-05.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tsDyn_irf_1_shock_fun &lt;- function (object, shock, hist,</span></span>
<span id="cb51-2"><a href="topic-05.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    n.ahead = 10, innov = NULL, shock_both = TRUE, </span></span>
<span id="cb51-3"><a href="topic-05.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    returnStarting = FALSE, add.regime = FALSE, seed = NULL) {</span></span>
<span id="cb51-4"><a href="topic-05.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-5"><a href="topic-05.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb51-6"><a href="topic-05.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  object <span class="ot">&lt;-</span> vecm.tsdyn</span>
<span id="cb51-7"><a href="topic-05.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-8"><a href="topic-05.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  shock <span class="ot">&lt;-</span> M<span class="sc">$</span>shock[[i]]</span>
<span id="cb51-9"><a href="topic-05.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  hist <span class="ot">&lt;-</span> M<span class="sc">$</span>hist[[i]]</span>
<span id="cb51-10"><a href="topic-05.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-11"><a href="topic-05.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  n.ahead <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb51-12"><a href="topic-05.html#cb51-12" aria-hidden="true" tabindex="-1"></a>  innov <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb51-13"><a href="topic-05.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  shock_both <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb51-14"><a href="topic-05.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  returnStarting <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb51-15"><a href="topic-05.html#cb51-15" aria-hidden="true" tabindex="-1"></a>  add.regime <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb51-16"><a href="topic-05.html#cb51-16" aria-hidden="true" tabindex="-1"></a>  add.regime <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb51-17"><a href="topic-05.html#cb51-17" aria-hidden="true" tabindex="-1"></a>  seed <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb51-18"><a href="topic-05.html#cb51-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-19"><a href="topic-05.html#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="topic-05.html#cb51-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-21"><a href="topic-05.html#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lag &lt;- get_lag(object)</span></span>
<span id="cb51-22"><a href="topic-05.html#cb51-22" aria-hidden="true" tabindex="-1"></a>  lag <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_lag.nlVar</span>(object)</span>
<span id="cb51-23"><a href="topic-05.html#cb51-23" aria-hidden="true" tabindex="-1"></a>  n_start <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">inherits</span>(object, <span class="fu">c</span>(<span class="st">&quot;VECM&quot;</span>, <span class="st">&quot;TVECM&quot;</span>)), lag <span class="sc">+</span> <span class="dv">1</span>, lag)</span>
<span id="cb51-24"><a href="topic-05.html#cb51-24" aria-hidden="true" tabindex="-1"></a>  include <span class="ot">&lt;-</span> object<span class="sc">$</span>include</span>
<span id="cb51-25"><a href="topic-05.html#cb51-25" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">coef</span>(object, <span class="at">hyperCoef =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-26"><a href="topic-05.html#cb51-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nthresh &lt;- get_nthresh(object)</span></span>
<span id="cb51-27"><a href="topic-05.html#cb51-27" aria-hidden="true" tabindex="-1"></a>  nthresh <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_nthresh.nlVar</span>(object)</span>
<span id="cb51-28"><a href="topic-05.html#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Thresh &lt;- getTh(object)</span></span>
<span id="cb51-29"><a href="topic-05.html#cb51-29" aria-hidden="true" tabindex="-1"></a>  Thresh <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">getTh.nlVar</span>(object)</span>
<span id="cb51-30"><a href="topic-05.html#cb51-30" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n.ahead <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb51-31"><a href="topic-05.html#cb51-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># K &lt;- get_nVar(object)</span></span>
<span id="cb51-32"><a href="topic-05.html#cb51-32" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_nVar.nlVar</span>(object)</span>
<span id="cb51-33"><a href="topic-05.html#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># series &lt;- get_series(object)</span></span>
<span id="cb51-34"><a href="topic-05.html#cb51-34" aria-hidden="true" tabindex="-1"></a>  series <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">get_series</span>(object)</span>
<span id="cb51-35"><a href="topic-05.html#cb51-35" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> object<span class="sc">$</span>model.specific<span class="sc">$</span>coint</span>
<span id="cb51-36"><a href="topic-05.html#cb51-36" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="cf">switch</span>(<span class="fu">class</span>(object)[[<span class="dv">1</span>]],</span>
<span id="cb51-37"><a href="topic-05.html#cb51-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ar =</span> <span class="st">&quot;setar&quot;</span>,</span>
<span id="cb51-38"><a href="topic-05.html#cb51-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linear =</span> <span class="st">&quot;setar&quot;</span>, </span>
<span id="cb51-39"><a href="topic-05.html#cb51-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">setar =</span> <span class="st">&quot;setar&quot;</span>,</span>
<span id="cb51-40"><a href="topic-05.html#cb51-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">VAR =</span> <span class="st">&quot;TVAR&quot;</span>,</span>
<span id="cb51-41"><a href="topic-05.html#cb51-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TVAR =</span> <span class="st">&quot;TVAR&quot;</span>, </span>
<span id="cb51-42"><a href="topic-05.html#cb51-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">VECM =</span> <span class="st">&quot;TVECM&quot;</span>,</span>
<span id="cb51-43"><a href="topic-05.html#cb51-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TVECM =</span> <span class="st">&quot;TVECM&quot;</span>, <span class="fu">stop</span>(<span class="st">&quot;Error model not recognised!&quot;</span>))</span>
<span id="cb51-44"><a href="topic-05.html#cb51-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(object, <span class="fu">c</span>(<span class="st">&quot;TVAR&quot;</span>, <span class="st">&quot;TVECM&quot;</span>))) {</span>
<span id="cb51-45"><a href="topic-05.html#cb51-45" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;cbind&quot;</span>, B)</span>
<span id="cb51-46"><a href="topic-05.html#cb51-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-47"><a href="topic-05.html#cb51-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(innov)) {</span>
<span id="cb51-48"><a href="topic-05.html#cb51-48" aria-hidden="true" tabindex="-1"></a>    res_obj <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">residuals</span>(object))</span>
<span id="cb51-49"><a href="topic-05.html#cb51-49" aria-hidden="true" tabindex="-1"></a>    res_obj <span class="ot">&lt;-</span> res_obj[<span class="sc">-</span><span class="fu">seq_len</span>(lag), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb51-50"><a href="topic-05.html#cb51-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(seed)) {</span>
<span id="cb51-51"><a href="topic-05.html#cb51-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set.seed</span>(seed)</span>
<span id="cb51-52"><a href="topic-05.html#cb51-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-53"><a href="topic-05.html#cb51-53" aria-hidden="true" tabindex="-1"></a>    index_samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(res_obj)), N, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-54"><a href="topic-05.html#cb51-54" aria-hidden="true" tabindex="-1"></a>    innov <span class="ot">&lt;-</span> res_obj <span class="ot">&lt;-</span> res_obj[index_samp, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb51-55"><a href="topic-05.html#cb51-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-56"><a href="topic-05.html#cb51-56" aria-hidden="true" tabindex="-1"></a>  hist_M <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(hist)</span>
<span id="cb51-57"><a href="topic-05.html#cb51-57" aria-hidden="true" tabindex="-1"></a>  shock_M <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(shock)</span>
<span id="cb51-58"><a href="topic-05.html#cb51-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(hist_M) <span class="sc">!=</span> n_start) {</span>
<span id="cb51-59"><a href="topic-05.html#cb51-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;hist should be of same nrow as lag (+1 if VECM)&quot;</span>)</span>
<span id="cb51-60"><a href="topic-05.html#cb51-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-61"><a href="topic-05.html#cb51-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">ncol</span>(hist_M) <span class="sc">!=</span> K) {</span>
<span id="cb51-62"><a href="topic-05.html#cb51-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;hist should be of same ncol as number of variables&quot;</span>)</span>
<span id="cb51-63"><a href="topic-05.html#cb51-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-64"><a href="topic-05.html#cb51-64" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(shock_M) <span class="sc">!=</span> <span class="dv">1</span>) {</span>
<span id="cb51-65"><a href="topic-05.html#cb51-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;shock should have only one row&quot;</span>)</span>
<span id="cb51-66"><a href="topic-05.html#cb51-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-67"><a href="topic-05.html#cb51-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">ncol</span>(shock_M) <span class="sc">!=</span> K) {</span>
<span id="cb51-68"><a href="topic-05.html#cb51-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;shock should be of same ncol as number of variables&quot;</span>)</span>
<span id="cb51-69"><a href="topic-05.html#cb51-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-70"><a href="topic-05.html#cb51-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(innov) <span class="sc">!=</span> N) {</span>
<span id="cb51-71"><a href="topic-05.html#cb51-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;innov should be of same length as n.ahead + 1&quot;</span>)</span>
<span id="cb51-72"><a href="topic-05.html#cb51-72" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-73"><a href="topic-05.html#cb51-73" aria-hidden="true" tabindex="-1"></a>  innov_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(shock_M, innov[<span class="sc">-</span><span class="dv">1</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb51-74"><a href="topic-05.html#cb51-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (shock_both) {</span>
<span id="cb51-75"><a href="topic-05.html#cb51-75" aria-hidden="true" tabindex="-1"></a>    innov_1 <span class="ot">&lt;-</span> innov <span class="sc">+</span> <span class="fu">rbind</span>(shock_M, <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n.ahead, <span class="at">ncol =</span> K))</span>
<span id="cb51-76"><a href="topic-05.html#cb51-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-77"><a href="topic-05.html#cb51-77" aria-hidden="true" tabindex="-1"></a>  innov_2 <span class="ot">&lt;-</span> innov</span>
<span id="cb51-78"><a href="topic-05.html#cb51-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sim_1 &lt;- model.gen(model = model, B = B, lag = lag, include = include, </span></span>
<span id="cb51-79"><a href="topic-05.html#cb51-79" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    nthresh = nthresh, Thresh = Thresh, beta = beta, starting = hist_M, </span></span>
<span id="cb51-80"><a href="topic-05.html#cb51-80" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    innov = innov_1, n = N, returnStarting = TRUE, add.regime = add.regime)</span></span>
<span id="cb51-81"><a href="topic-05.html#cb51-81" aria-hidden="true" tabindex="-1"></a>  sim_1 <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">model.gen</span>(<span class="at">model =</span> model, <span class="at">B =</span> B, <span class="at">lag =</span> lag, <span class="at">include =</span> include, </span>
<span id="cb51-82"><a href="topic-05.html#cb51-82" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nthresh =</span> nthresh, <span class="at">Thresh =</span> Thresh, <span class="at">beta =</span> beta, <span class="at">starting =</span> hist_M, </span>
<span id="cb51-83"><a href="topic-05.html#cb51-83" aria-hidden="true" tabindex="-1"></a>                     <span class="at">innov =</span> innov_1, <span class="at">n =</span> N, <span class="at">returnStarting =</span> <span class="cn">TRUE</span>, <span class="at">add.regime =</span> add.regime)</span>
<span id="cb51-84"><a href="topic-05.html#cb51-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sim_2 &lt;- model.gen(model = model, B = B, lag = lag, include = include, </span></span>
<span id="cb51-85"><a href="topic-05.html#cb51-85" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    nthresh = nthresh, Thresh = Thresh, beta = beta, starting = hist_M, </span></span>
<span id="cb51-86"><a href="topic-05.html#cb51-86" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                    innov = innov_2, n = N, returnStarting = TRUE, add.regime = add.regime)</span></span>
<span id="cb51-87"><a href="topic-05.html#cb51-87" aria-hidden="true" tabindex="-1"></a>  sim_2 <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">model.gen</span>(<span class="at">model =</span> model, <span class="at">B =</span> B, <span class="at">lag =</span> lag, <span class="at">include =</span> include, </span>
<span id="cb51-88"><a href="topic-05.html#cb51-88" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nthresh =</span> nthresh, <span class="at">Thresh =</span> Thresh, <span class="at">beta =</span> beta, <span class="at">starting =</span> hist_M, </span>
<span id="cb51-89"><a href="topic-05.html#cb51-89" aria-hidden="true" tabindex="-1"></a>                     <span class="at">innov =</span> innov_2, <span class="at">n =</span> N, <span class="at">returnStarting =</span> <span class="cn">TRUE</span>, <span class="at">add.regime =</span> add.regime)</span>
<span id="cb51-90"><a href="topic-05.html#cb51-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-91"><a href="topic-05.html#cb51-91" aria-hidden="true" tabindex="-1"></a>  n.aheads_all <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>n_start<span class="sc">:</span><span class="dv">0</span>, <span class="fu">seq_len</span>(n.ahead))</span>
<span id="cb51-92"><a href="topic-05.html#cb51-92" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (K <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb51-93"><a href="topic-05.html#cb51-93" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var =</span> <span class="fu">rep</span>(series, <span class="at">each =</span> <span class="fu">nrow</span>(sim_1)), <span class="at">n.ahead =</span> n.aheads_all, <span class="at">sim_1 =</span> <span class="fu">unlist</span>(sim_1), <span class="at">sim_2 =</span> <span class="fu">unlist</span>(sim_2))</span>
<span id="cb51-94"><a href="topic-05.html#cb51-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(df))</span>
<span id="cb51-95"><a href="topic-05.html#cb51-95" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb51-96"><a href="topic-05.html#cb51-96" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var =</span> series, <span class="at">n.ahead =</span> n.aheads_all, <span class="at">sim_1 =</span> sim_1<span class="sc">$</span>res, <span class="at">sim_2 =</span> sim_2<span class="sc">$</span>res)</span>
<span id="cb51-97"><a href="topic-05.html#cb51-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-98"><a href="topic-05.html#cb51-98" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (add.regime) {</span>
<span id="cb51-99"><a href="topic-05.html#cb51-99" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb51-100"><a href="topic-05.html#cb51-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n.ahead&quot;</span>, <span class="st">&quot;sim_1&quot;</span>, <span class="st">&quot;regime_1&quot;</span>, <span class="st">&quot;sim_2&quot;</span>)</span>
<span id="cb51-101"><a href="topic-05.html#cb51-101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-102"><a href="topic-05.html#cb51-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>returnStarting) {</span>
<span id="cb51-103"><a href="topic-05.html#cb51-103" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, n.ahead <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb51-104"><a href="topic-05.html#cb51-104" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-105"><a href="topic-05.html#cb51-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-106"><a href="topic-05.html#cb51-106" aria-hidden="true" tabindex="-1"></a>  df</span></code></pre></div>
<pre><code>##          var n.ahead    sim_1    sim_2
## 3   long.run       0 9.197031 9.464327
## 4   long.run       1 8.898894 9.185726
## 5   long.run       2 8.836150 9.127755
## 6   long.run       3 8.697946 8.992235
## 7   long.run       4 8.665609 8.962129
## 8   long.run       5 8.557435 8.855936
## 9   long.run       6 8.381104 8.681379
## 10  long.run       7 8.319928 8.621796
## 11  long.run       8 8.036332 8.339629
## 12  long.run       9 7.586294 7.890872
## 13  long.run      10 7.646679 7.952406
## 16 short.run       0 7.689293 8.106952
## 17 short.run       1 6.944679 7.456274
## 18 short.run       2 7.047379 7.549121
## 19 short.run       3 6.976456 7.459606
## 20 short.run       4 7.565632 8.030996
## 21 short.run       5 7.237260 7.686543
## 22 short.run       6 6.906369 7.341211
## 23 short.run       7 6.727155 7.149041
## 24 short.run       8 6.632981 7.043244
## 25 short.run       9 5.937837 6.337673
## 26 short.run      10 5.666728 6.057210</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="topic-05.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="topic-05.html#cb54-1" aria-hidden="true" tabindex="-1"></a>tsDyn_model_gen_fun <span class="ot">&lt;-</span> <span class="cf">function</span> (<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;setar&quot;</span>, <span class="st">&quot;TVAR&quot;</span>, <span class="st">&quot;TVECM&quot;</span>), B, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">lag =</span> <span class="dv">1</span>, </span>
<span id="cb54-2"><a href="topic-05.html#cb54-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">include =</span> <span class="fu">c</span>(<span class="st">&quot;const&quot;</span>, <span class="st">&quot;trend&quot;</span>, <span class="st">&quot;none&quot;</span>, <span class="st">&quot;both&quot;</span>), <span class="at">nthresh =</span> <span class="dv">0</span>, </span>
<span id="cb54-3"><a href="topic-05.html#cb54-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">thDelay =</span> <span class="dv">0</span>, Thresh, <span class="at">trendStart =</span> <span class="dv">1</span>, <span class="at">starting =</span> <span class="cn">NULL</span>, innov, </span>
<span id="cb54-4"><a href="topic-05.html#cb54-4" aria-hidden="true" tabindex="-1"></a>                                 exo, <span class="at">round_digits =</span> <span class="dv">10</span>, <span class="at">returnStarting =</span> <span class="cn">FALSE</span>, <span class="at">add.regime =</span> <span class="cn">FALSE</span>, </span>
<span id="cb54-5"><a href="topic-05.html#cb54-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">show.parMat =</span> <span class="cn">FALSE</span>, <span class="at">thVar =</span> <span class="cn">NULL</span>, <span class="at">mTh =</span> <span class="dv">1</span>, beta, ...) {</span>
<span id="cb54-6"><a href="topic-05.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-7"><a href="topic-05.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> model</span>
<span id="cb54-8"><a href="topic-05.html#cb54-8" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> B</span>
<span id="cb54-9"><a href="topic-05.html#cb54-9" aria-hidden="true" tabindex="-1"></a>  lag <span class="ot">&lt;-</span> lag</span>
<span id="cb54-10"><a href="topic-05.html#cb54-10" aria-hidden="true" tabindex="-1"></a>  include <span class="ot">&lt;-</span> include</span>
<span id="cb54-11"><a href="topic-05.html#cb54-11" aria-hidden="true" tabindex="-1"></a>  nthresh <span class="ot">&lt;-</span> nthresh</span>
<span id="cb54-12"><a href="topic-05.html#cb54-12" aria-hidden="true" tabindex="-1"></a>  Thresh <span class="ot">&lt;-</span> Thresh</span>
<span id="cb54-13"><a href="topic-05.html#cb54-13" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> beta</span>
<span id="cb54-14"><a href="topic-05.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  starting <span class="ot">&lt;-</span> hist_M</span>
<span id="cb54-15"><a href="topic-05.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  innov <span class="ot">&lt;-</span> innov_1</span>
<span id="cb54-16"><a href="topic-05.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> N</span>
<span id="cb54-17"><a href="topic-05.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-18"><a href="topic-05.html#cb54-18" aria-hidden="true" tabindex="-1"></a>  thDelay <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-19"><a href="topic-05.html#cb54-19" aria-hidden="true" tabindex="-1"></a>  trendStart <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-20"><a href="topic-05.html#cb54-20" aria-hidden="true" tabindex="-1"></a>  exo <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb54-21"><a href="topic-05.html#cb54-21" aria-hidden="true" tabindex="-1"></a>  round_digits <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb54-22"><a href="topic-05.html#cb54-22" aria-hidden="true" tabindex="-1"></a>  returnStarting <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb54-23"><a href="topic-05.html#cb54-23" aria-hidden="true" tabindex="-1"></a>  add.regime <span class="ot">&lt;-</span> add.regime</span>
<span id="cb54-24"><a href="topic-05.html#cb54-24" aria-hidden="true" tabindex="-1"></a>  show.parMat <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb54-25"><a href="topic-05.html#cb54-25" aria-hidden="true" tabindex="-1"></a>  thVar <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb54-26"><a href="topic-05.html#cb54-26" aria-hidden="true" tabindex="-1"></a>  mTh <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb54-27"><a href="topic-05.html#cb54-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-28"><a href="topic-05.html#cb54-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-29"><a href="topic-05.html#cb54-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-30"><a href="topic-05.html#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># model &lt;- match.arg(model)</span></span>
<span id="cb54-31"><a href="topic-05.html#cb54-31" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> model</span>
<span id="cb54-32"><a href="topic-05.html#cb54-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">&quot;setar&quot;</span>) {</span>
<span id="cb54-33"><a href="topic-05.html#cb54-33" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">setar.gen</span>(<span class="at">B =</span> B, <span class="at">n =</span> n, <span class="at">lag =</span> lag, <span class="at">include =</span> include, </span>
<span id="cb54-34"><a href="topic-05.html#cb54-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nthresh =</span> nthresh, <span class="at">Thresh =</span> Thresh, <span class="at">thDelay =</span> thDelay, </span>
<span id="cb54-35"><a href="topic-05.html#cb54-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">starting =</span> <span class="fu">as.numeric</span>(starting[, <span class="dv">1</span>]), <span class="at">innov =</span> innov, </span>
<span id="cb54-36"><a href="topic-05.html#cb54-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">exo =</span> exo, <span class="at">trendStart =</span> trendStart, <span class="at">round_digits =</span> round_digits, </span>
<span id="cb54-37"><a href="topic-05.html#cb54-37" aria-hidden="true" tabindex="-1"></a>                             <span class="at">returnStarting =</span> returnStarting, <span class="at">add.regime =</span> add.regime, </span>
<span id="cb54-38"><a href="topic-05.html#cb54-38" aria-hidden="true" tabindex="-1"></a>                             <span class="at">show.parMat =</span> show.parMat, ...)</span>
<span id="cb54-39"><a href="topic-05.html#cb54-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">&quot;TVAR&quot;</span>) {</span>
<span id="cb54-40"><a href="topic-05.html#cb54-40" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">TVAR.gen</span>(<span class="at">B =</span> B, <span class="at">n =</span> n, <span class="at">lag =</span> lag, <span class="at">include =</span> include, </span>
<span id="cb54-41"><a href="topic-05.html#cb54-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nthresh =</span> nthresh, <span class="at">Thresh =</span> Thresh, <span class="at">thDelay =</span> thDelay, </span>
<span id="cb54-42"><a href="topic-05.html#cb54-42" aria-hidden="true" tabindex="-1"></a>                            <span class="at">starting =</span> starting, <span class="at">innov =</span> innov, <span class="at">thVar =</span> thVar, </span>
<span id="cb54-43"><a href="topic-05.html#cb54-43" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mTh =</span> mTh, <span class="at">trendStart =</span> trendStart, <span class="at">round_digits =</span> round_digits, </span>
<span id="cb54-44"><a href="topic-05.html#cb54-44" aria-hidden="true" tabindex="-1"></a>                            <span class="at">returnStarting =</span> returnStarting, <span class="at">add.regime =</span> add.regime, </span>
<span id="cb54-45"><a href="topic-05.html#cb54-45" aria-hidden="true" tabindex="-1"></a>                            <span class="at">show.parMat =</span> show.parMat, ...)</span>
<span id="cb54-46"><a href="topic-05.html#cb54-46" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">&quot;TVECM&quot;</span>) {</span>
<span id="cb54-47"><a href="topic-05.html#cb54-47" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">TVECM.gen</span>(<span class="at">B =</span> B, <span class="at">n =</span> n, <span class="at">lag =</span> lag, <span class="at">include =</span> include, </span>
<span id="cb54-48"><a href="topic-05.html#cb54-48" aria-hidden="true" tabindex="-1"></a>                             <span class="at">beta =</span> beta, <span class="at">nthresh =</span> nthresh, <span class="at">Thresh =</span> Thresh, </span>
<span id="cb54-49"><a href="topic-05.html#cb54-49" aria-hidden="true" tabindex="-1"></a>                             <span class="at">starting =</span> starting, <span class="at">innov =</span> innov, <span class="at">round_digits =</span> round_digits, </span>
<span id="cb54-50"><a href="topic-05.html#cb54-50" aria-hidden="true" tabindex="-1"></a>                             <span class="at">returnStarting =</span> returnStarting, <span class="at">show.parMat =</span> show.parMat, ...)</span>
<span id="cb54-51"><a href="topic-05.html#cb54-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-52"><a href="topic-05.html#cb54-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(res)</span>
<span id="cb54-53"><a href="topic-05.html#cb54-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="topic-05.html#cb55-1" aria-hidden="true" tabindex="-1"></a>tsDyn_TVECM_gen_fun <span class="ot">&lt;-</span> <span class="cf">function</span> (B, beta, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">lag =</span> <span class="dv">1</span>,</span>
<span id="cb55-2"><a href="topic-05.html#cb55-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">include =</span> <span class="fu">c</span>(<span class="st">&quot;const&quot;</span>, <span class="st">&quot;trend&quot;</span>, <span class="st">&quot;none&quot;</span>, <span class="st">&quot;both&quot;</span>), <span class="at">nthresh =</span> <span class="dv">1</span>, Thresh,</span>
<span id="cb55-3"><a href="topic-05.html#cb55-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">starting =</span> <span class="cn">NULL</span>, innov, <span class="at">returnStarting =</span> <span class="cn">FALSE</span>, <span class="at">show.parMat =</span> <span class="cn">FALSE</span>, <span class="at">round_digits =</span> <span class="dv">4</span>) {</span>
<span id="cb55-4"><a href="topic-05.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-5"><a href="topic-05.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inputs</span></span>
<span id="cb55-6"><a href="topic-05.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> B</span>
<span id="cb55-7"><a href="topic-05.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n</span>
<span id="cb55-8"><a href="topic-05.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  lag <span class="ot">&lt;-</span> lag</span>
<span id="cb55-9"><a href="topic-05.html#cb55-9" aria-hidden="true" tabindex="-1"></a>  include <span class="ot">&lt;-</span> include</span>
<span id="cb55-10"><a href="topic-05.html#cb55-10" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> beta</span>
<span id="cb55-11"><a href="topic-05.html#cb55-11" aria-hidden="true" tabindex="-1"></a>  nthresh <span class="ot">&lt;-</span> nthresh</span>
<span id="cb55-12"><a href="topic-05.html#cb55-12" aria-hidden="true" tabindex="-1"></a>  Thresh <span class="ot">&lt;-</span> Thresh</span>
<span id="cb55-13"><a href="topic-05.html#cb55-13" aria-hidden="true" tabindex="-1"></a>  starting <span class="ot">&lt;-</span> starting</span>
<span id="cb55-14"><a href="topic-05.html#cb55-14" aria-hidden="true" tabindex="-1"></a>  innov <span class="ot">&lt;-</span> innov</span>
<span id="cb55-15"><a href="topic-05.html#cb55-15" aria-hidden="true" tabindex="-1"></a>  round_digits <span class="ot">&lt;-</span> round_digits</span>
<span id="cb55-16"><a href="topic-05.html#cb55-16" aria-hidden="true" tabindex="-1"></a>  returnStarting <span class="ot">&lt;-</span> returnStarting</span>
<span id="cb55-17"><a href="topic-05.html#cb55-17" aria-hidden="true" tabindex="-1"></a>  show.parMat <span class="ot">&lt;-</span> show.parMat</span>
<span id="cb55-18"><a href="topic-05.html#cb55-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-19"><a href="topic-05.html#cb55-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-20"><a href="topic-05.html#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="topic-05.html#cb55-21" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> lag</span>
<span id="cb55-22"><a href="topic-05.html#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># include &lt;- match.arg(include)</span></span>
<span id="cb55-23"><a href="topic-05.html#cb55-23" aria-hidden="true" tabindex="-1"></a>  include <span class="ot">&lt;-</span> include</span>
<span id="cb55-24"><a href="topic-05.html#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>nthresh <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) {</span>
<span id="cb55-25"><a href="topic-05.html#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Arg nthresh should  be either 0, 1 or 2&quot;</span>)</span>
<span id="cb55-26"><a href="topic-05.html#cb55-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-27"><a href="topic-05.html#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(beta)) {</span>
<span id="cb55-28"><a href="topic-05.html#cb55-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;please provide arg beta (cointegrating value)&quot;</span>)</span>
<span id="cb55-29"><a href="topic-05.html#cb55-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-30"><a href="topic-05.html#cb55-30" aria-hidden="true" tabindex="-1"></a>  ninc <span class="ot">&lt;-</span> <span class="cf">switch</span>(include, <span class="at">none =</span> <span class="dv">0</span>, <span class="at">const =</span> <span class="dv">1</span>, <span class="at">trend =</span> <span class="dv">1</span>, <span class="at">both =</span> <span class="dv">2</span>)</span>
<span id="cb55-31"><a href="topic-05.html#cb55-31" aria-hidden="true" tabindex="-1"></a>  incVal <span class="ot">&lt;-</span> <span class="cf">switch</span>(include, <span class="at">none =</span> <span class="cn">NULL</span>, <span class="at">const =</span> <span class="st">&quot;const&quot;</span>, <span class="at">trend =</span> <span class="st">&quot;trend&quot;</span>, <span class="at">both =</span> <span class="fu">c</span>(<span class="st">&quot;const&quot;</span>, <span class="st">&quot;trend&quot;</span>))</span>
<span id="cb55-32"><a href="topic-05.html#cb55-32" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(B)</span>
<span id="cb55-33"><a href="topic-05.html#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.vector</span>(beta)) {</span>
<span id="cb55-34"><a href="topic-05.html#cb55-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(beta) <span class="sc">==</span> k <span class="sc">-</span> <span class="dv">1</span>) {</span>
<span id="cb55-35"><a href="topic-05.html#cb55-35" aria-hidden="true" tabindex="-1"></a>      beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span>beta)</span>
<span id="cb55-36"><a href="topic-05.html#cb55-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-37"><a href="topic-05.html#cb55-37" aria-hidden="true" tabindex="-1"></a>    tBETA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(beta, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb55-38"><a href="topic-05.html#cb55-38" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb55-39"><a href="topic-05.html#cb55-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb55-40"><a href="topic-05.html#cb55-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(beta) <span class="sc">!=</span> k) {</span>
<span id="cb55-41"><a href="topic-05.html#cb55-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;beta should have k rows and r cols&quot;</span>)</span>
<span id="cb55-42"><a href="topic-05.html#cb55-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-43"><a href="topic-05.html#cb55-43" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">ncol</span>(beta)</span>
<span id="cb55-44"><a href="topic-05.html#cb55-44" aria-hidden="true" tabindex="-1"></a>    tBETA <span class="ot">&lt;-</span> <span class="fu">t</span>(beta)</span>
<span id="cb55-45"><a href="topic-05.html#cb55-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-46"><a href="topic-05.html#cb55-46" aria-hidden="true" tabindex="-1"></a>  esp <span class="ot">&lt;-</span> p <span class="sc">*</span> k <span class="sc">+</span> r <span class="sc">+</span> ninc</span>
<span id="cb55-47"><a href="topic-05.html#cb55-47" aria-hidden="true" tabindex="-1"></a>  pa <span class="ot">&lt;-</span> <span class="cf">switch</span>(<span class="fu">as.character</span>(nthresh), <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;_low&quot;</span>, <span class="st">&quot;_upr&quot;</span>), <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;_low&quot;</span>, <span class="st">&quot;_mid&quot;</span>, <span class="st">&quot;_upr&quot;</span>))</span>
<span id="cb55-48"><a href="topic-05.html#cb55-48" aria-hidden="true" tabindex="-1"></a>  lags <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">outer</span>(<span class="st">&quot;L{x&quot;</span>, <span class="dv">1</span><span class="sc">:</span>k, paste, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb55-49"><a href="topic-05.html#cb55-49" aria-hidden="true" tabindex="-1"></a>  lags2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rep</span>(lags, <span class="at">times =</span> p), <span class="st">&quot;}{&quot;</span>, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="at">each =</span> p), <span class="st">&quot;}&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb55-50"><a href="topic-05.html#cb55-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (esp <span class="sc">*</span> (nthresh <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">!=</span> <span class="fu">ncol</span>(B)) {</span>
<span id="cb55-51"><a href="topic-05.html#cb55-51" aria-hidden="true" tabindex="-1"></a>    colnames_Matrix_input <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">outer</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;ECT&quot;</span>, r), incVal, lags2), pa, paste, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb55-52"><a href="topic-05.html#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Matrix B badly specified: should have &quot;</span>, esp <span class="sc">*</span> (nthresh <span class="sc">+</span> <span class="dv">1</span>), <span class="st">&quot;columns, but has&quot;</span>, <span class="fu">ncol</span>(B), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb55-53"><a href="topic-05.html#cb55-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> esp <span class="sc">*</span> (nthresh <span class="sc">+</span> <span class="dv">1</span>), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">paste</span>(<span class="st">&quot;Equ x&quot;</span>, <span class="dv">1</span><span class="sc">:</span>k, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), colnames_Matrix_input)))</span>
<span id="cb55-54"><a href="topic-05.html#cb55-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>()</span>
<span id="cb55-55"><a href="topic-05.html#cb55-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-56"><a href="topic-05.html#cb55-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(B) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Equ x&quot;</span>, <span class="dv">1</span><span class="sc">:</span>k, <span class="st">&quot;:&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb55-57"><a href="topic-05.html#cb55-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(starting)) {</span>
<span id="cb55-58"><a href="topic-05.html#cb55-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.matrix</span>(starting)) {</span>
<span id="cb55-59"><a href="topic-05.html#cb55-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;Provide &#39;starting&#39; as matrix&quot;</span>)</span>
<span id="cb55-60"><a href="topic-05.html#cb55-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-61"><a href="topic-05.html#cb55-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="fu">dim</span>(starting) <span class="sc">==</span> <span class="fu">c</span>(p <span class="sc">+</span> <span class="dv">1</span>, k))) {</span>
<span id="cb55-62"><a href="topic-05.html#cb55-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;Bad specification of starting values. Should have nrow = lag +1 and ncol = number of variables&quot;</span>)</span>
<span id="cb55-63"><a href="topic-05.html#cb55-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-64"><a href="topic-05.html#cb55-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-65"><a href="topic-05.html#cb55-65" aria-hidden="true" tabindex="-1"></a>  Bmat <span class="ot">&lt;-</span> B</span>
<span id="cb55-66"><a href="topic-05.html#cb55-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (include <span class="sc">!=</span> <span class="st">&quot;both&quot;</span>) {</span>
<span id="cb55-67"><a href="topic-05.html#cb55-67" aria-hidden="true" tabindex="-1"></a>    aa1 <span class="ot">&lt;-</span> r <span class="sc">+</span> <span class="cf">switch</span>(include, <span class="at">none =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">const =</span> <span class="dv">2</span>, <span class="at">trend =</span> <span class="dv">1</span>, <span class="at">both =</span> <span class="cn">NULL</span>)</span>
<span id="cb55-68"><a href="topic-05.html#cb55-68" aria-hidden="true" tabindex="-1"></a>    aa <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rep</span>(aa1, <span class="at">each =</span> nthresh <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span>nthresh) <span class="sc">*</span> (p <span class="sc">*</span> k <span class="sc">+</span> <span class="fu">max</span>(aa1)))</span>
<span id="cb55-69"><a href="topic-05.html#cb55-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bmat &lt;- myInsertCol(Bmat, c = aa, 0)</span></span>
<span id="cb55-70"><a href="topic-05.html#cb55-70" aria-hidden="true" tabindex="-1"></a>    Bmat <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">myInsertCol</span>(Bmat, <span class="at">c =</span> aa, <span class="dv">0</span>)</span>
<span id="cb55-71"><a href="topic-05.html#cb55-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-72"><a href="topic-05.html#cb55-72" aria-hidden="true" tabindex="-1"></a>  nparBmat <span class="ot">&lt;-</span> p <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span> <span class="sc">+</span> r</span>
<span id="cb55-73"><a href="topic-05.html#cb55-73" aria-hidden="true" tabindex="-1"></a>  Yb <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n <span class="sc">+</span> p <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> k)</span>
<span id="cb55-74"><a href="topic-05.html#cb55-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(starting)) {</span>
<span id="cb55-75"><a href="topic-05.html#cb55-75" aria-hidden="true" tabindex="-1"></a>    Yb[<span class="dv">1</span><span class="sc">:</span>(p <span class="sc">+</span> <span class="dv">1</span>), ] <span class="ot">&lt;-</span> starting</span>
<span id="cb55-76"><a href="topic-05.html#cb55-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-77"><a href="topic-05.html#cb55-77" aria-hidden="true" tabindex="-1"></a>  trend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, p <span class="sc">+</span> <span class="dv">1</span>), <span class="fu">seq_len</span>(n))</span>
<span id="cb55-78"><a href="topic-05.html#cb55-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-79"><a href="topic-05.html#cb55-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># start generation of Yb</span></span>
<span id="cb55-80"><a href="topic-05.html#cb55-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-81"><a href="topic-05.html#cb55-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (nthresh <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb55-82"><a href="topic-05.html#cb55-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (p <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">:</span>(n <span class="sc">+</span> p <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb55-83"><a href="topic-05.html#cb55-83" aria-hidden="true" tabindex="-1"></a>      ECT <span class="ot">&lt;-</span> Bmat[, <span class="dv">1</span><span class="sc">:</span>r] <span class="sc">%*%</span> tBETA <span class="sc">%*%</span> <span class="fu">matrix</span>(Yb[i <span class="sc">-</span> <span class="dv">1</span>, ], <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb55-84"><a href="topic-05.html#cb55-84" aria-hidden="true" tabindex="-1"></a>      Yb[i, ] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(Yb[i <span class="sc">-</span> <span class="dv">1</span>, ], Bmat[, r <span class="sc">+</span> <span class="dv">1</span>], Bmat[, r <span class="sc">+</span> <span class="dv">2</span>] <span class="sc">*</span> trend[i], ECT, Bmat[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(r <span class="sc">+</span> <span class="dv">2</span>))] <span class="sc">%*%</span> <span class="fu">matrix</span>(<span class="fu">t</span>(Yb[i <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p), ] <span class="sc">-</span> Yb[i <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span>(p <span class="sc">+</span> <span class="dv">1</span>)), ]), <span class="at">ncol =</span> <span class="dv">1</span>), innov[i <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>, ]))</span>
<span id="cb55-85"><a href="topic-05.html#cb55-85" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-86"><a href="topic-05.html#cb55-86" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (nthresh <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb55-87"><a href="topic-05.html#cb55-87" aria-hidden="true" tabindex="-1"></a>    BD <span class="ot">&lt;-</span> Bmat[, <span class="fu">seq_len</span>(nparBmat)]</span>
<span id="cb55-88"><a href="topic-05.html#cb55-88" aria-hidden="true" tabindex="-1"></a>    BU <span class="ot">&lt;-</span> Bmat[, <span class="sc">-</span><span class="fu">seq_len</span>(nparBmat)]</span>
<span id="cb55-89"><a href="topic-05.html#cb55-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (p <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">:</span>(n <span class="sc">+</span> p <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb55-90"><a href="topic-05.html#cb55-90" aria-hidden="true" tabindex="-1"></a>      ECT <span class="ot">&lt;-</span> Yb[i <span class="sc">-</span> <span class="dv">1</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> <span class="fu">t</span>(tBETA)</span>
<span id="cb55-91"><a href="topic-05.html#cb55-91" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">round</span>(ECT, round_digits) <span class="sc">&lt;=</span> Thresh) {</span>
<span id="cb55-92"><a href="topic-05.html#cb55-92" aria-hidden="true" tabindex="-1"></a>        B_here <span class="ot">&lt;-</span> BD</span>
<span id="cb55-93"><a href="topic-05.html#cb55-93" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb55-94"><a href="topic-05.html#cb55-94" aria-hidden="true" tabindex="-1"></a>        B_here <span class="ot">&lt;-</span> BU</span>
<span id="cb55-95"><a href="topic-05.html#cb55-95" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb55-96"><a href="topic-05.html#cb55-96" aria-hidden="true" tabindex="-1"></a>      Yb[i, ] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(Yb[i <span class="sc">-</span> <span class="dv">1</span>, ], B_here[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fu">as.vector</span>(ECT), B_here[, <span class="dv">2</span>], B_here[, <span class="dv">3</span>] <span class="sc">*</span> trend[i], B_here[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)] <span class="sc">%*%</span> <span class="fu">matrix</span>(<span class="fu">t</span>(Yb[i <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p), ] <span class="sc">-</span> Yb[i <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span>(p <span class="sc">+</span> <span class="dv">1</span>)), ]), <span class="at">ncol =</span> <span class="dv">1</span>), innov[i <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>, ]))</span>
<span id="cb55-97"><a href="topic-05.html#cb55-97" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-98"><a href="topic-05.html#cb55-98" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (nthresh <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb55-99"><a href="topic-05.html#cb55-99" aria-hidden="true" tabindex="-1"></a>    BD <span class="ot">&lt;-</span> Bmat[, <span class="fu">seq_len</span>(nparBmat)]</span>
<span id="cb55-100"><a href="topic-05.html#cb55-100" aria-hidden="true" tabindex="-1"></a>    BM <span class="ot">&lt;-</span> Bmat[, <span class="fu">seq_len</span>(nparBmat) <span class="sc">+</span> nparBmat]</span>
<span id="cb55-101"><a href="topic-05.html#cb55-101" aria-hidden="true" tabindex="-1"></a>    BU <span class="ot">&lt;-</span> Bmat[, <span class="fu">seq_len</span>(nparBmat) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> nparBmat]</span>
<span id="cb55-102"><a href="topic-05.html#cb55-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (p <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">:</span>(n <span class="sc">+</span> p <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb55-103"><a href="topic-05.html#cb55-103" aria-hidden="true" tabindex="-1"></a>      ECT <span class="ot">&lt;-</span> Yb[i <span class="sc">-</span> <span class="dv">1</span>, , drop <span class="ot">=</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> <span class="fu">t</span>(tBETA)</span>
<span id="cb55-104"><a href="topic-05.html#cb55-104" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">round</span>(ECT, round_digits) <span class="sc">&lt;=</span> Thresh[<span class="dv">1</span>]) {</span>
<span id="cb55-105"><a href="topic-05.html#cb55-105" aria-hidden="true" tabindex="-1"></a>        B_here <span class="ot">&lt;-</span> BD</span>
<span id="cb55-106"><a href="topic-05.html#cb55-106" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">round</span>(ECT, round_digits) <span class="sc">&gt;</span> Thresh[<span class="dv">2</span>]) {</span>
<span id="cb55-107"><a href="topic-05.html#cb55-107" aria-hidden="true" tabindex="-1"></a>        B_here <span class="ot">&lt;-</span> BU</span>
<span id="cb55-108"><a href="topic-05.html#cb55-108" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb55-109"><a href="topic-05.html#cb55-109" aria-hidden="true" tabindex="-1"></a>        B_here <span class="ot">&lt;-</span> BM</span>
<span id="cb55-110"><a href="topic-05.html#cb55-110" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb55-111"><a href="topic-05.html#cb55-111" aria-hidden="true" tabindex="-1"></a>      Yb[i, ] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">cbind</span>(Yb[i <span class="sc">-</span> <span class="dv">1</span>, ], B_here[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fu">as.vector</span>(ECT), B_here[, <span class="dv">2</span>], B_here[, <span class="dv">3</span>] <span class="sc">*</span> trend[i], B_here[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)] <span class="sc">%*%</span> <span class="fu">matrix</span>(<span class="fu">t</span>(Yb[i <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p), ] <span class="sc">-</span> Yb[i <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span>(p <span class="sc">+</span> <span class="dv">1</span>)), ]), <span class="at">ncol =</span> <span class="dv">1</span>), innov[i <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>, ]))</span>
<span id="cb55-112"><a href="topic-05.html#cb55-112" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-113"><a href="topic-05.html#cb55-113" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-114"><a href="topic-05.html#cb55-114" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show.parMat) {</span>
<span id="cb55-115"><a href="topic-05.html#cb55-115" aria-hidden="true" tabindex="-1"></a>    colnames_Matrix_system <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">outer</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;ECT&quot;</span>, r), <span class="st">&quot;Const&quot;</span>, <span class="st">&quot;Trend&quot;</span>, lags2), pa, paste, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb55-116"><a href="topic-05.html#cb55-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(Bmat) <span class="ot">&lt;-</span> colnames_Matrix_system</span>
<span id="cb55-117"><a href="topic-05.html#cb55-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(Bmat)</span>
<span id="cb55-118"><a href="topic-05.html#cb55-118" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-119"><a href="topic-05.html#cb55-119" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>returnStarting) {</span>
<span id="cb55-120"><a href="topic-05.html#cb55-120" aria-hidden="true" tabindex="-1"></a>    Yb <span class="ot">&lt;-</span> Yb[<span class="sc">-</span><span class="fu">seq_len</span>(p <span class="sc">+</span> <span class="dv">1</span>), ]</span>
<span id="cb55-121"><a href="topic-05.html#cb55-121" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-122"><a href="topic-05.html#cb55-122" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb55-123"><a href="topic-05.html#cb55-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Yb)</span>
<span id="cb55-124"><a href="topic-05.html#cb55-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-125"><a href="topic-05.html#cb55-125" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Strategies to hijack <code>tsDyn:::GIRF</code> function</p>
<ul>
<li>edit <code>tsDyn::TVECM</code> function for known breaks to create ingredients of <code>tsDyn:::GIRF</code> function.</li>
</ul>
</div>
<div id="tvecm-model-estimation" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> TVECM model estimation<a href="topic-05.html#tvecm-model-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="topic-05.html#cb56-1" aria-hidden="true" tabindex="-1"></a>tvec <span class="ot">&lt;-</span> tsDyn<span class="sc">::</span><span class="fu">TVECM</span>(tsDyn<span class="sc">::</span>zeroyldMeta[, <span class="fu">c</span>(<span class="st">&quot;long.run&quot;</span>, <span class="st">&quot;short.run&quot;</span>)], <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">ngridTh =</span> <span class="dv">300</span>, <span class="at">beta =</span> <span class="fu">list</span>(<span class="at">exact =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## 2 (0.7%) points of the grid lead to regimes with percentage of observations &lt; trim and were not computed</code></pre>
<p><img src="topics-in-statistics-and-econometrics_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="tvecm-model-orthngalized-irf-analysis" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> TVECM model orthngalized IRF analysis<a href="topic-05.html#tvecm-model-orthngalized-irf-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="topic-05.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># don&#39;t run</span></span>
<span id="cb58-2"><a href="topic-05.html#cb58-2" aria-hidden="true" tabindex="-1"></a>irf.tvec <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">irf.VECM</span>(tvec, <span class="at">ortho =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="topic-05.html#cb59-1" aria-hidden="true" tabindex="-1"></a>irf.tvec <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">irf.TVECM</span>(tvec, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>, <span class="at">n.ahead =</span> <span class="dv">10</span>)</span>
<span id="cb59-2"><a href="topic-05.html#cb59-2" aria-hidden="true" tabindex="-1"></a>irf.tvec<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##            long.run     short.run
##  [1,]  0.0000000000  0.3201782612
##  [2,] -0.0417116461  0.0295448213
##  [3,] -0.0152852188 -0.0548594485
##  [4,]  0.0516574379 -0.0003151505
##  [5,]  0.0413890468  0.0635663107
##  [6,] -0.0065558061 -0.0062368076
##  [7,]  0.0001577064 -0.0244389162
##  [8,]  0.0313667356  0.0328783020
##  [9,]  0.0221484845  0.0458458385
## [10,]  0.0003683447 -0.0005472588
## [11,]  0.0100973499 -0.0066522541</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="topic-05.html#cb61-1" aria-hidden="true" tabindex="-1"></a>irf.tvec<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##         long.run   short.run
##  [1,] 0.29654579  0.37579964
##  [2,] 0.25826203  0.48847064
##  [3,] 0.07754857  0.05482439
##  [4,] 0.14984722 -0.01328498
##  [5,] 0.28559826  0.28278939
##  [6,] 0.21498971  0.31928930
##  [7,] 0.11600731  0.10205934
##  [8,] 0.17582624  0.10356710
##  [9,] 0.24355831  0.26466235
## [10,] 0.19303490  0.24664211
## [11,] 0.14810080  0.12696172</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="topic-05.html#cb63-1" aria-hidden="true" tabindex="-1"></a>irf.l.tvec <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">irf.TVECM</span>(tvec, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">regime =</span> <span class="st">&quot;L&quot;</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>, <span class="at">n.ahead =</span> <span class="dv">10</span>)</span>
<span id="cb63-2"><a href="topic-05.html#cb63-2" aria-hidden="true" tabindex="-1"></a>irf.l.tvec<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##            long.run     short.run
##  [1,]  0.0000000000  0.3201782612
##  [2,] -0.0417116461  0.0295448213
##  [3,] -0.0152852188 -0.0548594485
##  [4,]  0.0516574379 -0.0003151505
##  [5,]  0.0413890468  0.0635663107
##  [6,] -0.0065558061 -0.0062368076
##  [7,]  0.0001577064 -0.0244389162
##  [8,]  0.0313667356  0.0328783020
##  [9,]  0.0221484845  0.0458458385
## [10,]  0.0003683447 -0.0005472588
## [11,]  0.0100973499 -0.0066522541</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="topic-05.html#cb65-1" aria-hidden="true" tabindex="-1"></a>irf.l.tvec<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##         long.run   short.run
##  [1,] 0.29654579  0.37579964
##  [2,] 0.25826203  0.48847064
##  [3,] 0.07754857  0.05482439
##  [4,] 0.14984722 -0.01328498
##  [5,] 0.28559826  0.28278939
##  [6,] 0.21498971  0.31928930
##  [7,] 0.11600731  0.10205934
##  [8,] 0.17582624  0.10356710
##  [9,] 0.24355831  0.26466235
## [10,] 0.19303490  0.24664211
## [11,] 0.14810080  0.12696172</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="topic-05.html#cb67-1" aria-hidden="true" tabindex="-1"></a>irf.h.tvec <span class="ot">&lt;-</span> tsDyn<span class="sc">:::</span><span class="fu">irf.TVECM</span>(tvec, <span class="at">ortho =</span> <span class="cn">TRUE</span>, <span class="at">regime =</span> <span class="st">&quot;H&quot;</span>, <span class="at">boot =</span> <span class="cn">FALSE</span>, <span class="at">n.ahead =</span> <span class="dv">10</span>)</span>
<span id="cb67-2"><a href="topic-05.html#cb67-2" aria-hidden="true" tabindex="-1"></a>irf.h.tvec<span class="sc">$</span>irf<span class="sc">$</span>short.run</span></code></pre></div>
<pre><code>##         long.run short.run
##  [1,] 0.00000000 0.3201783
##  [2,] 0.02892842 0.3592035
##  [3,] 0.02935621 0.3401690
##  [4,] 0.03117986 0.3238179
##  [5,] 0.03377063 0.3089948
##  [6,] 0.03620496 0.2953376
##  [7,] 0.03851678 0.2825830
##  [8,] 0.04069657 0.2705763
##  [9,] 0.04274829 0.2592656
## [10,] 0.04468054 0.2486118
## [11,] 0.04650045 0.2385771</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="topic-05.html#cb69-1" aria-hidden="true" tabindex="-1"></a>irf.h.tvec<span class="sc">$</span>irf<span class="sc">$</span>long.run</span></code></pre></div>
<pre><code>##        long.run short.run
##  [1,] 0.2965458 0.3757996
##  [2,] 0.3172186 0.4793394
##  [3,] 0.3221100 0.5025273
##  [4,] 0.3242745 0.4960566
##  [5,] 0.3254243 0.4868761
##  [6,] 0.3267788 0.4786850
##  [7,] 0.3281280 0.4711548
##  [8,] 0.3294040 0.4641105
##  [9,] 0.3306066 0.4574831
## [10,] 0.3317391 0.4512405
## [11,] 0.3328055 0.4453604</code></pre>
</div>
<div id="tvecm-model-generalized-irf-analysis" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> TVECM model generalized IRF analysis<a href="topic-05.html#tvecm-model-generalized-irf-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<script src="script.js"></script>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="topic-04.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mmoessler/topics-in-statistics-and-econometrics/blob/main/06-topic-05.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
